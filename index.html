<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PomodoroCycle Timer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@700&display=swap" rel="stylesheet">
    <link id="favicon" rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text x="50" y="50" font-size="90" dominant-baseline="middle" text-anchor="middle">üçÖ</text></svg>'>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.5s ease;
            overflow-y: scroll; 
        }
        .timer-text {
            font-family: 'Roboto Mono', monospace;
            font-size: 6rem; 
            line-height: 1;
            letter-spacing: -0.05em;
            font-weight: 700;
        }
        .tab-button.active {
            border-bottom-width: 4px;
        }
        .achievement-item { 
            height: 7rem; 
            display: flex;
            flex-direction: column;
            justify-content: space-between; 
            overflow: hidden; 
            position: relative; 
        }
        .modal { display: none; }
        .modal.show { display: flex; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        .progress-bar-container {
            width: 100%;
            height: 6px; 
            background-color: #e0e0e0; 
            border-radius: 3px; 
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background-color: #4caf50; 
            border-radius: 3px; 
            transition: width 0.3s ease-in-out;
        }
        .help-content ul { list-style-type: none; padding-left: 0; margin-bottom: 10px; }
        .help-content li { margin-bottom: 5px; }
        .help-content li.break-session { color: #a0aec0; }
        #toastNotification {
            position: fixed; top: 20px; right: 20px; padding: 1rem; border-radius: 0.5rem;
            color: white; font-size: 0.875rem; z-index: 1000; opacity: 0;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
            max-width: 300px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transform: translateX(100%);
        }
        #toastNotification.show { opacity: 1; transform: translateX(0); }
        #toastNotification.success { background-color: #34d399; } 
        #toastNotification.error { background-color: #ef4444; } 
        #toastNotification.info { background-color: #3b82f6; } 
        #toastNotification.warning { background-color: #f59e0b; } 
        .tab-badge {
            position: absolute; top: 0.5rem; right: 0.5rem; background-color: #ef4444;
            color: white; border-radius: 9999px; padding: 0.1rem 0.4rem;
            font-size: 0.65rem; font-weight: bold; line-height: 1;
            min-width: 1rem; text-align: center; display: none; 
        }
        .tab-button { position: relative; }
        .new-indicator { font-size: 0.65rem; padding: 0.1rem 0.3rem; border-radius: 0.25rem; line-height: 1; }
        .cycle-dot {
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 9999px;
            transition: all 0.3s ease;
        }
        .donation-section {
            text-align: center;
            font-size: 0.75em;
            color: #5a687d;
            margin-top: 20px;
            max-width: 320px;
            opacity: 0.75;
            line-height: 1.4;
        }
        .donation-section a {
            color: #5a687d;
            text-decoration: none;
            white-space: nowrap;
            transition: color 0.3s ease;
        }
        .donation-section a:hover {
            color: #FFDD00;
        }
    </style>
</head>
<body class="bg-slate-900 text-white flex flex-col items-center min-h-screen p-4 selection:bg-sky-400 selection:text-sky-900">

    <div id="languageModal" class="modal fixed inset-0 bg-slate-900 bg-opacity-95 items-center justify-center p-4 z-[200]">
        <div class="bg-slate-800 p-8 rounded-2xl shadow-2xl w-full max-w-sm text-center">
            <h2 class="text-2xl font-bold mb-2 text-sky-300">Select Your Language</h2>
            <p class="text-slate-400 mb-6">Choose your preferred language to continue.</p>
            <div id="languageButtonsContainer" class="flex flex-col space-y-3">
            </div>
            <p class="text-xs text-slate-500 mt-6"><i class="fas fa-info-circle fa-fw mr-1.5 opacity-70"></i>You can change this choice later in the settings.</p>
        </div>
    </div>

    <div id="app-container" class="w-full hidden">
        <div class="w-full max-w-3xl mx-auto bg-slate-800 shadow-2xl rounded-lg p-6 relative mt-4 mb-4"> 
            <div class="absolute top-6 left-6 z-10">
                 <button id="helpButton" data-translate-key="help_tooltip" title="Help / How to Use" class="p-2 rounded-full text-sky-400 hover:bg-slate-700 hover:text-sky-300 transition-colors focus:outline-none">
                     <i class="fas fa-question-circle text-xl"></i>
                 </button>
            </div>
            <div class="absolute top-6 right-6 z-10">
                <button id="settingsButton" data-translate-key="settings_tooltip" title="Settings" class="p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none">
                    <i class="fas fa-cog text-xl text-sky-400 hover:text-sky-300"></i>
                </button>
            </div>

            <div id="timerDisplay" class="relative text-center mb-6 pt-8 md:pt-4 pb-4 rounded-lg bg-slate-700 shadow-inner">
                <div id="modeIndicator" class="h-8 flex items-center justify-center mb-2 text-slate-300 font-medium">
                    <span data-translate-key="current_timer_label">Current Timer:</span>&nbsp;
                    <span id="modePill" class="py-1 px-3 rounded-full text-sm font-semibold transition-all duration-500" data-translate-key="mode_study">Focus</span>
                </div>
               
                <p id="timerText" class="timer-text text-sky-400 transition-colors duration-500">25:00</p>
               
                <div class="flex justify-center items-center mt-4 h-8">
                    <div id="cycleDotsContainer" data-translate-key="cycle_tooltip" title="Focus Sessions in Current Cycle" class="flex items-center justify-center space-x-2.5">
                          <div class="cycle-dot"></div>
                          <div class="cycle-dot"></div>
                          <div class="cycle-dot"></div>
                          <div class="cycle-dot"></div>
                    </div>
                    <button id="resetCycleCountButton" data-translate-key="reset_cycle_tooltip" title="Reset Cycle" class="ml-3 text-slate-500 hover:text-sky-400 transition-colors focus:outline-none focus:ring-0 text-[11px]">
                          <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
               
                <button id="skipBreakButton" class="absolute bottom-3 right-3 hidden bg-slate-600 hover:bg-slate-500 text-slate-300 text-xs py-1.5 px-3 rounded-md shadow-md transition-colors">
                    <i class="fas fa-forward fa-xs mr-1"></i><span data-translate-key="skip_break_button">Skip Break</span>
                </button>
            </div>

            <div class="flex justify-center items-center space-x-4 mb-8">
                <button id="startPauseButton" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-transform transform hover:scale-105">
                    <i class="fas fa-play mr-2"></i><span data-translate-key="start_button">Start</span>
                </button>
                <button id="resetButton" class="bg-slate-600 hover:bg-slate-500 text-slate-300 py-2 px-4 rounded-lg shadow-md transition-colors text-xs">
                    <i class="fas fa-undo fa-sm mr-1"></i><span data-translate-key="reset_current_button">Reset Current</span>
                </button>
            </div>
           
            <div class="mb-6 border-b border-slate-700">
                <nav class="flex space-x-1 -mb-px">
                    <button data-tab="stats" class="tab-button active text-sky-400 border-sky-400 py-3 px-4 font-medium text-center hover:text-sky-300 hover:border-sky-300 transition-colors">
                        <i class="fas fa-chart-line mr-2"></i><span data-translate-key="tab_stats">Statistics</span>
                    </button>
                    <button data-tab="rewards" class="tab-button text-slate-400 border-transparent py-3 px-4 font-medium text-center hover:text-sky-300 hover:border-sky-300 transition-colors">
                        <i class="fas fa-gift mr-2"></i><span data-translate-key="tab_rewards">Daily Rewards</span> <span id="rewardsTabBadge" class="tab-badge"></span>
                    </button>
                    <button data-tab="achievements" class="tab-button text-slate-400 border-transparent py-3 px-4 font-medium text-center hover:text-sky-300 hover:border-sky-300 transition-colors">
                        <i class="fas fa-trophy mr-2"></i><span data-translate-key="tab_achievements">Achievements</span> <span id="achievementsTabBadge" class="tab-badge"></span>
                    </button>
                </nav>
            </div>

            <div id="tabContent"> 
                <div id="statsContent" class="tab-pane active p-4 bg-slate-700 rounded-b-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold text-sky-300" data-translate-key="stats_title">Your Statistics</h3>
                        <p id="streakContainerHeader" class="text-base text-slate-300"><span data-translate-key="stats_streak">Focus Streak</span>: <span id="streakCounterHeader" class="font-semibold">0</span> <span id="streakFireIconContainer"><i class="fas fa-fire"></i></span></p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-slate-600 p-4 rounded-lg shadow">
                            <h4 class="font-bold text-sky-400" data-translate-key="stats_daily_title">Daily:</h4>
                            <p><span data-translate-key="stats_daily_cycles">Cycles Completed Today</span>: <span id="dailyCycles">0</span></p>
                            <p><span data-translate-key="stats_daily_study_time">Pure Focus Time Today</span>: <span id="dailyStudyTime">0h 0m</span></p>
                            <p><span data-translate-key="stats_daily_total_time">Total Time Today</span>: <span id="dailyTotalTime">0h 0m</span></p>
                        </div>
                        <div class="bg-slate-600 p-4 rounded-lg shadow">
                            <h4 class="font-bold text-sky-400" data-translate-key="stats_general_title">General:</h4>
                            <p><span data-translate-key="stats_general_cycles">Total Cycles Completed</span>: <span id="totalCycles">0</span></p>
                            <p><span data-translate-key="stats_general_study_time">Total Pure Focus Time</span>: <span id="totalStudyTime">0h 0m</span></p>
                            <p><span data-translate-key="stats_general_days">Total Focus Days</span>: <span id="totalDaysStudied">0</span></p>
                        </div>
                    </div>
                </div>
                <div id="rewardsContent" class="tab-pane hidden p-4 bg-slate-700 rounded-b-lg">
                    <h3 class="text-xl font-semibold mb-4 text-sky-300" data-translate-key="rewards_title">Manage Daily Rewards</h3>
                    <div class="mb-4 p-3 bg-slate-600 rounded-lg md:flex md:items-center md:space-x-2 md:flex-wrap">
                        <input type="text" id="rewardName" data-translate-key="rewards_name_placeholder" placeholder="Reward name" class="w-full md:flex-1 p-2 rounded bg-slate-500 text-white placeholder-slate-300 mb-2 md:mb-0">
                        <select id="rewardType" class="w-full md:w-auto p-2 rounded bg-slate-500 text-white mb-2 md:mb-0">
                            <option value="cycles" data-translate-key="rewards_type_cycles">Completed Cycles</option>
                            <option value="studyHours" data-translate-key="rewards_type_hours">Focus Hours</option>
                        </select>
                        <input type="number" id="rewardThreshold" data-translate-key="rewards_value_placeholder" placeholder="Value" step="0.5" min="0" class="w-full md:w-28 p-2 rounded bg-slate-500 text-white placeholder-slate-300 mb-2 md:mb-0">
                        <button id="addRewardButton" class="w-full md:w-auto mt-2 md:mt-0 bg-green-500 hover:bg-green-600 text-white font-bold py-1.5 px-3 rounded transition-colors" data-translate-key="rewards_add_button">Add Reward</button>
                    </div>
                    <div id="rewardsList" class="space-y-2 max-h-[176px] overflow-y-auto pr-2"></div>
                </div>
                <div id="achievementsContent" class="tab-pane hidden p-4 bg-slate-700 rounded-b-lg">
                    <h3 class="text-xl font-semibold mb-4 text-sky-300" data-translate-key="achievements_title">Your Achievements</h3>
                    <div id="achievementsList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 max-h-64 overflow-y-auto pr-2"></div>
                </div>
            </div>
            <div class="mt-4 text-center">
                <p class="text-xs text-slate-500">
                    <i class="fas fa-info-circle mr-1"></i><span data-translate-key="storage_warning">Your progress is saved in your browser's local storage. Clearing browser data may delete your progress.</span>
                </p>
            </div>
        </div>

        <div class="donation-section mx-auto">
            <p data-translate-key="donation_text">If you'd like to support this app, you can do so <a href="https://www.buymeacoffee.com/lemonade299792458" target="_blank">here ‚òï</a></p>
        </div>
    </div>
   
    <div id="settingsModal" class="modal fixed inset-0 bg-black bg-opacity-75 items-center justify-center p-4 z-50 overflow-y-auto">
        <div class="bg-slate-800 p-6 rounded-2xl shadow-2xl w-full max-w-lg my-8">
            <div class="p-4 bg-slate-700 rounded-lg mb-6">
                <h3 class="text-lg font-semibold mb-4 text-sky-400" data-translate-key="settings_section_timer">Timer Durations</h3>
                <div class="space-y-4">
                    <div>
                        <label for="studyTimeInput" class="block text-sm font-medium text-slate-300 mb-1" data-translate-key="settings_study_time">Focus Time (minutes):</label>
                        <input type="number" id="studyTimeInput" min="1" class="w-full p-2 bg-slate-600 border border-slate-500 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500">
                    </div>
                    <div>
                        <label for="shortBreakTimeInput" class="block text-sm font-medium text-slate-300 mb-1" data-translate-key="settings_short_break">Short Break (minutes):</label>
                        <input type="number" id="shortBreakTimeInput" min="1" class="w-full p-2 bg-slate-600 border border-slate-500 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500">
                    </div>
                    <div>
                        <label for="longBreakTimeInput" class="block text-sm font-medium text-slate-300 mb-1" data-translate-key="settings_long_break">Long Break (minutes):</label>
                        <input type="number" id="longBreakTimeInput" min="1" class="w-full p-2 bg-slate-600 border border-slate-500 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500">
                    </div>
                </div>
            </div>

            <div class="p-4 bg-slate-700 rounded-lg mb-6">
                <h3 class="text-lg font-semibold mb-4 text-sky-400" data-translate-key="settings_section_prefs">Preferences</h3>
                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-slate-300" data-translate-key="settings_enable_sounds">Enable Sounds:</span>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="soundToggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-600 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-sky-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-sky-500"></div>
                        </label>
                    </div>
                    <div>
                        <label for="languageSelect" class="block text-sm font-medium text-slate-300 mb-1" data-translate-key="settings_language">Language:</label>
                        <select id="languageSelect" class="w-full p-2 bg-slate-600 border border-slate-500 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500">
                            <option value="en">English</option>
                            <option value="pt-BR">Portugu√™s (Brasil)</option>
                            <option value="es">Espa√±ol</option>
                            <option value="zh-CN">‰∏≠Êñá (ÁÆÄ‰Ωì)</option>
                            <option value="hi-IN">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="p-4 bg-slate-700 rounded-lg mb-6">
                <h3 class="text-lg font-semibold mb-2 text-sky-400" data-translate-key="settings_data_management">Data Management</h3>
                 <p class="text-xs text-slate-400 mb-4" data-translate-key="settings_data_info">Save your progress to a file or load it on another device.</p>
                <div class="flex flex-col sm:flex-row gap-3">
                    <button id="exportDataButton" class="flex-1 px-4 py-2 text-sm font-medium text-white bg-slate-600 hover:bg-slate-500 rounded-md transition-colors flex items-center justify-center gap-2">
                        <i class="fas fa-download"></i><span data-translate-key="settings_export_button">Export Data</span>
                    </button>
                    <button id="importDataButton" class="flex-1 px-4 py-2 text-sm font-medium text-white bg-slate-600 hover:bg-slate-500 rounded-md transition-colors flex items-center justify-center gap-2">
                         <i class="fas fa-upload"></i><span data-translate-key="settings_import_button">Import Data</span>
                    </button>
                    <input type="file" id="importFileInput" class="hidden" accept=".json">
                </div>
            </div>

            <div class="mt-8 flex justify-end space-x-3">
                <button id="cancelSettingsButton" class="px-4 py-2 text-sm font-medium text-slate-300 bg-slate-600 hover:bg-slate-500 rounded-md transition-colors" data-translate-key="cancel_button">Cancel</button>
                <button id="saveSettingsButton" class="px-4 py-2 text-sm font-medium text-white bg-sky-500 hover:bg-sky-600 rounded-md transition-colors" data-translate-key="save_button">Save Settings</button>
            </div>
        </div>
    </div>
    <div id="customAlertModal" class="modal fixed inset-0 bg-black bg-opacity-75 items-center justify-center p-4 z-[100]">
        <div class="bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-md text-left"> 
            <div class="flex items-start">
                <div id="customAlertIcon" class="text-3xl mr-4 mt-1"></div> 
                <div>
                    <h3 id="customAlertTitle" class="text-xl font-bold mb-2"></h3>
                    <div id="customAlertMessage" class="text-slate-300 mb-6 help-content text-sm"></div>
                </div>
            </div>
            <div id="customAlertButtons" class="flex justify-end space-x-3"> 
                <button id="customAlertCancelButton" class="px-4 py-2 text-sm font-medium text-slate-300 bg-slate-600 hover:bg-slate-500 rounded-md transition-colors">Cancel</button>
                <button id="customAlertConfirmButton" class="px-4 py-2 text-sm font-medium text-white bg-sky-500 hover:bg-sky-600 rounded-md transition-colors">OK</button>
            </div>
        </div>
    </div>
    <div id="toastNotification">
        <strong id="toastTitle" class="font-bold"></strong>
        <p id="toastBody"></p>
    </div>
    <script id="timerWorkerScript" type="javascript/worker">
        let workerTimeLeft; let workerIsRunning=!1; let workerTimerInterval; let workerCurrentMode; let workerSettings={}; function startWorkerTimer(){if(workerIsRunning)return;if(workerTimeLeft<=0){postMessage({type:"end",mode:workerCurrentMode});return}workerIsRunning=!0;workerTimerInterval=setInterval(()=>{if(!workerIsRunning){clearInterval(workerTimerInterval);return}workerTimeLeft--;postMessage({type:"tick",timeLeft:workerTimeLeft,mode:workerCurrentMode});if(workerTimeLeft<=0){clearInterval(workerTimerInterval);workerIsRunning=!1;postMessage({type:"end",mode:workerCurrentMode})}},1e3)}self.onmessage=function(e){const{command:o,mode:t,duration:s,settings:i}=e.data;switch(o){case"start":workerIsRunning||startWorkerTimer();break;case"pause":workerIsRunning=!1;clearInterval(workerTimerInterval);break;case"setMode":workerCurrentMode=t;workerTimeLeft=s;workerIsRunning=!1;clearInterval(workerTimerInterval);postMessage({type:"modeSet",timeLeft:workerTimeLeft,mode:workerCurrentMode});break;case"updateSettings":workerSettings=i;if(!workerIsRunning&&workerCurrentMode){let e;e="study"===workerCurrentMode?workerSettings.studyTime*60:"shortBreak"===workerCurrentMode?workerSettings.shortBreakTime*60:"longBreak"===workerCurrentMode?workerSettings.longBreakTime*60:null;e&&workerTimeLeft!==e&&(workerTimeLeft=e,postMessage({type:"tick",timeLeft:workerTimeLeft,mode:workerCurrentMode}))}}};
    </script>
    <script>
        const baseAchievements = [{"id":"days1","type":"totalDaysStudied","threshold":1,"icon":"fas fa-seedling"},{"id":"days7","type":"totalDaysStudied","threshold":7,"icon":"fas fa-calendar-check"},{"id":"days15","type":"totalDaysStudied","threshold":15,"icon":"fas fa-medal"},{"id":"days30","type":"totalDaysStudied","threshold":30,"icon":"fas fa-award"},{"id":"days50","type":"totalDaysStudied","threshold":50,"icon":"fas fa-star"},{"id":"days75","type":"totalDaysStudied","threshold":75,"icon":"fas fa-running"},{"id":"days100","type":"totalDaysStudied","threshold":100,"icon":"fas fa-crown"},{"id":"days120","type":"totalDaysStudied","threshold":120,"icon":"fas fa-book-reader"},{"id":"days150","type":"totalDaysStudied","threshold":150,"icon":"fas fa-graduation-cap"},{"id":"streak3","type":"streak","threshold":3,"icon":"fas fa-fire"},{"id":"streak7","type":"streak","threshold":7,"icon":"fas fa-bolt"},{"id":"streak14","type":"streak","threshold":14,"icon":"fas fa-dumbbell"},{"id":"streak30","type":"streak","threshold":30,"icon":"fas fa-calendar-alt"},{"id":"streak50","type":"streak","threshold":50,"icon":"fas fa-shield-alt"},{"id":"cycles1","type":"totalCyclesCompleted","threshold":1,"icon":"fas fa-flag-checkered"},{"id":"cycles10","type":"totalCyclesCompleted","threshold":10,"icon":"fas fa-spinner fa-spin"},{"id":"cycles25","type":"totalCyclesCompleted","threshold":25,"icon":"fas fa-cogs"},{"id":"cycles50","type":"totalCyclesCompleted","threshold":50,"icon":"fas fa-rocket"},{"id":"cycles100","type":"totalCyclesCompleted","threshold":100,"icon":"fas fa-gem"},{"id":"hours1","type":"totalPureStudyHours","threshold":1,"icon":"fas fa-hourglass-start"},{"id":"hours10","type":"totalPureStudyHours","threshold":10,"icon":"fas fa-brain"},{"id":"hours50","type":"totalPureStudyHours","threshold":50,"icon":"fas fa-microscope"},{"id":"hours100","type":"totalPureStudyHours","threshold":100,"icon":"fas fa-university"},{"id":"sb_hours_1","type":"totalShortBreakSeconds","threshold":3600,"icon":"fas fa-coffee"},{"id":"sb_hours_5","type":"totalShortBreakSeconds","threshold":18000,"icon":"fas fa-mug-hot"},{"id":"sb_hours_15","type":"totalShortBreakSeconds","threshold":54000,"icon":"fas fa-couch"},{"id":"lb_hours_3","type":"totalLongBreakSeconds","threshold":10800,"icon":"fas fa-bed"},{"id":"lb_hours_10","type":"totalLongBreakSeconds","threshold":36000,"icon":"fas fa-battery-full"},{"id":"lb_hours_25","type":"totalLongBreakSeconds","threshold":90000,"icon":"fas fa-umbrella-beach"}];

        const translations = {
            'en': {
                app_title: "PomodoroCycle Timer",
                help_tooltip: "Help / How to Use",
                settings_tooltip: "Settings",
                current_timer_label: "Current Timer:",
                mode_study: "Focus",
                mode_short_break: "Short Break",
                mode_long_break: "Long Break",
                cycle_tooltip: "Focus Sessions in Current Cycle",
                reset_cycle_tooltip: "Reset Cycle",
                skip_break_button: "Skip Break",
                start_button: "Start",
                pause_button: "Pause",
                resume_button: "Resume",
                reset_current_button: "Reset Current",
                tab_stats: "Statistics",
                tab_rewards: "Daily Rewards",
                tab_achievements: "Achievements",
                stats_title: "Your Statistics",
                stats_streak: "Focus Streak",
                stats_daily_title: "Daily:",
                stats_daily_cycles: "Cycles Completed Today",
                stats_daily_study_time: "Pure Focus Time Today",
                stats_daily_total_time: "Total Time Today",
                stats_general_title: "General:",
                stats_general_cycles: "Total Cycles Completed",
                stats_general_study_time: "Total Pure Focus Time",
                stats_general_days: "Total Focus Days",
                rewards_title: "Manage Daily Rewards",
                rewards_name_placeholder: "Reward name",
                rewards_type_cycles: "Completed Cycles",
                rewards_type_hours: "Focus Hours",
                rewards_value_placeholder: "Value",
                rewards_add_button: "Add Reward",
                rewards_no_rewards: "No rewards configured.",
                rewards_goal_label: "Goal",
                rewards_progress_label: "Progress",
                rewards_earned_today: "Reward Earned Today!",
                achievements_title: "Your Achievements",
                storage_warning: "Your progress is saved in your browser's local storage. Clearing browser data may delete your progress.",
                donation_text: "If you'd like to support this app, you can do so {0}",
                donation_link_text: "here ‚òï",
                settings_title: "Timer Settings",
                settings_section_timer: "Timer Durations",
                settings_section_prefs: "Preferences",
                settings_study_time: "Focus Time (minutes):",
                settings_short_break: "Short Break (minutes):",
                settings_long_break: "Long Break (minutes):",
                settings_language: "Language:",
                settings_enable_sounds: "Enable Sounds:",
                settings_data_management: "Data Management",
                settings_data_info: "Save your progress to a file or load it on another device.",
                settings_export_button: "Export Data",
                settings_import_button: "Import Data",
                cancel_button: "Cancel",
                save_button: "Save Settings",
                confirm_button: "Confirm",
                ok_button: "OK",
                got_it_button: "Got it!",
                new_badge: "NEW!",
                unlocked_on_date: "Unlocked on: {0}",
                progress_label: "Progress: {0} / {1}",
                toast_error_title: "Error",
                toast_rewards_error: "Please fill in all reward fields correctly. Value must be 0 or greater.",
                toast_settings_saved_title: "Settings Saved",
                toast_settings_saved_body: "Your new timer durations have been applied.",
                toast_reward_earned_title: "Reward Earned!",
                toast_reward_earned_body: 'You earned the reward: "{0}"!',
                toast_achievement_unlocked_title: "Achievement Unlocked!",
                toast_achievement_unlocked_body: 'You unlocked the achievement: "{0}"!',
                toast_study_complete_title: "Focus Session Complete!",
                toast_study_complete_body: "Time for a break. Good job!",
                toast_break_over_title: "Break Over!",
                toast_break_over_body: "Time to get back to focus!",
                toast_long_break_over_title: "Long Break Over!",
                toast_long_break_over_body: "Cycle complete! Ready for a new one?",
                toast_cycle_complete_title: "Cycle Complete!",
                toast_cycle_complete_body: "Congratulations! You've completed a full Pomodoro cycle.",
                toast_new_day_title: "A New Day!",
                toast_new_day_body: "Your daily statistics have been reset.",
                toast_import_success_title: "Import Successful",
                toast_import_success_body: "Your progress has been restored. The page will now reload.",
                toast_import_error_title: "Import Failed",
                toast_import_error_body: "The selected file is not a valid backup file or is corrupted.",
                alert_reset_cycle_title: "Confirm Reset",
                alert_reset_cycle_body: "Are you sure you want to reset the current cycle? This will set the focus session to 1/4.",
                alert_help_title: "How This Pomodoro Timer Works",
                alert_help_body: `<p class="mb-3">The <strong>Pomodoro Technique</strong> is a time management method that uses a timer to break down work into intervals, traditionally 25 minutes in length, separated by short breaks.</p><p class="mb-1 font-semibold">This Timer's Cycle:</p><ul><li>1. Focus Session (e.g., 25 min)</li><li class="break-session" style="padding-left: 35px;">Short Break (e.g., 5 min)</li><li>2. Focus Session</li><li class="break-session" style="padding-left: 35px;">Short Break</li><li>3. Focus Session</li><li class="break-session" style="padding-left: 35px;">Short Break</li><li>4. Focus Session (completes 1 cycle)</li><li class="break-session" style="padding-left: 35px;">Long Break (e.g., 15 min)</li></ul><p class="mb-3">Focus sessions and breaks begin automatically. After the long break, however, you'll need to start the new cycle manually.</p><p class="mb-3">The focus streak only increases after completing the first focus session of the day.</p><p>Reset the cycle using the <i class='fas fa-sync-alt fa-xs'></i> button.</p>`,
                alert_import_title: "Import Progress?",
                alert_import_body: "This will overwrite all your current progress, achievements, and settings. This action cannot be undone. Are you sure you want to continue?",
                achievements: {
                    "days1": {"name":"Focused Beginner","description":"Complete your first day of focus."},
                    "days7": {"name":"Weekly Commitment","description":"Focus for 7 days."},
                    "days15": {"name":"Fortnightly Focus","description":"Focus for 15 days."},
                    "days30": {"name":"Monthly Landmark","description":"Focus for 30 days."},
                    "days50": {"name":"Shooting Star","description":"Focus for 50 days."},
                    "days75": {"name":"Focus Marathoner","description":"Focus for 75 days."},
                    "days100": {"name":"Habit Master","description":"Focus for 100 days."},
                    "days120": {"name":"Focus Legend","description":"Focus for 120 days."},
                    "days150": {"name":"Focus Sage","description":"Focus for 150 days."},
                    "streak3": {"name":"3-Day Combo!","description":"Maintain a 3-day focus streak."},
                    "streak7": {"name":"A Week Streak","description":"Maintain a 7-day focus streak."},
                    "streak14": {"name":"Habit Power-Up","description":"Maintain a 14-day focus streak."},
                    "streak30": {"name":"Unstoppable","description":"Maintain a 30-day focus streak."},
                    "streak50": {"name":"True Dedication","description":"Maintain a 50-day focus streak."},
                    "cycles1": {"name":"First Full Cycle","description":"Complete 1 Pomodoro cycle."},
                    "cycles10": {"name":"Ten Cycles of Focus","description":"Complete 10 Pomodoro cycles."},
                    "cycles25": {"name":"Productivity Pro","description":"Complete 25 Pomodoro cycles."},
                    "cycles50": {"name":"To The Moon","description":"Complete 50 Pomodoro cycles."},
                    "cycles100": {"name":"Cycle Centurion","description":"Complete 100 Pomodoro cycles."},
                    "hours1": {"name":"First Hour of Focus","description":"Accumulate 1 hour of pure focus."},
                    "hours10": {"name":"Immersive Thinker","description":"Accumulate 10 hours of pure focus."},
                    "hours50": {"name":"Knowledge Fountain","description":"Accumulate 50 hours of pure focus."},
                    "hours100": {"name":"Focus Scholar","description":"Accumulate 100 hours of pure focus."},
                    "sb_hours_1": {"name":"Quick Breather","description":"Accumulate 1 hour in short breaks."},
                    "sb_hours_5": {"name":"Relaxation Adept","description":"Accumulate 5 hours in short breaks."},
                    "sb_hours_15": {"name":"Short Break Champion","description":"Accumulate 15 hours in short breaks."},
                    "lb_hours_3": {"name":"Well Deserved Rest","description":"Accumulate 3 hours in long breaks."},
                    "lb_hours_10": {"name":"Recharge Master","description":"Accumulate 10 hours in long breaks."},
                    "lb_hours_25": {"name":"Leisure Expert","description":"Accumulate 25 hours in long breaks."}
                }
            },
            'pt-BR': {
                app_title: "PomodoroCycle Timer",
                help_tooltip: "Ajuda / Como Usar",
                settings_tooltip: "Configura√ß√µes",
                current_timer_label: "Timer Atual:",
                mode_study: "Foco",
                mode_short_break: "Pausa Curta",
                mode_long_break: "Pausa Longa",
                cycle_tooltip: "Sess√µes de foco no ciclo atual",
                reset_cycle_tooltip: "Reiniciar Ciclo",
                skip_break_button: "Pular Pausa",
                start_button: "Iniciar",
                pause_button: "Pausar",
                resume_button: "Retomar",
                reset_current_button: "Resetar Atual",
                tab_stats: "Estat√≠sticas",
                tab_rewards: "Recompensas Di√°rias",
                tab_achievements: "Conquistas",
                stats_title: "Suas Estat√≠sticas",
                stats_streak: "Sequ√™ncia de Foco",
                stats_daily_title: "Hoje:",
                stats_daily_cycles: "Ciclos Completos Hoje",
                stats_daily_study_time: "Tempo de Foco Puro Hoje",
                stats_daily_total_time: "Tempo Total Hoje",
                stats_general_title: "Geral:",
                stats_general_cycles: "Total de Ciclos Completos",
                stats_general_study_time: "Total de Tempo de Foco Puro",
                stats_general_days: "Total de Dias de Foco",
                rewards_title: "Gerenciar Recompensas",
                rewards_name_placeholder: "Nome da recompensa",
                rewards_type_cycles: "Ciclos Completos",
                rewards_type_hours: "Horas de Foco",
                rewards_value_placeholder: "Valor",
                rewards_add_button: "Adicionar",
                rewards_no_rewards: "Nenhuma recompensa configurada.",
                rewards_goal_label: "Meta",
                rewards_progress_label: "Progresso",
                rewards_earned_today: "Recompensa Ganhada!",
                achievements_title: "Suas Conquistas",
                storage_warning: "Seu progresso √© salvo no armazenamento local do navegador. Limpar os dados pode apagar seu progresso.",
                donation_text: "Se quiser apoiar este app, voc√™ pode faz√™-lo {0}",
                donation_link_text: "aqui ‚òï",
                settings_title: "Configura√ß√µes do Timer",
                settings_section_timer: "Dura√ß√µes do Timer",
                settings_section_prefs: "Prefer√™ncias",
                settings_study_time: "Tempo de Foco (minutos):",
                settings_short_break: "Pausa Curta (minutos):",
                settings_long_break: "Pausa Longa (minutos):",
                settings_language: "Idioma:",
                settings_enable_sounds: "Habilitar Sons:",
                settings_data_management: "Gest√£o de Dados",
                settings_data_info: "Salve seu progresso em um arquivo ou carregue-o em outro dispositivo.",
                settings_export_button: "Exportar Dados",
                settings_import_button: "Importar Dados",
                cancel_button: "Cancelar",
                save_button: "Salvar",
                confirm_button: "Confirmar",
                ok_button: "OK",
                got_it_button: "Entendi!",
                new_badge: "NOVO!",
                unlocked_on_date: "Desbloqueado em: {0}",
                progress_label: "Progresso: {0} / {1}",
                toast_error_title: "Erro",
                toast_rewards_error: "Preencha os campos corretamente. O valor deve ser 0 ou maior.",
                toast_settings_saved_title: "Configura√ß√µes Salvas",
                toast_settings_saved_body: "As novas dura√ß√µes do timer foram aplicadas.",
                toast_reward_earned_title: "Recompensa Ganhada!",
                toast_reward_earned_body: 'Voc√™ ganhou a recompensa: "{0}"!',
                toast_achievement_unlocked_title: "Conquista Desbloqueada!",
                toast_achievement_unlocked_body: 'Voc√™ desbloqueou a conquista: "{0}"!',
                toast_study_complete_title: "Sess√£o de Foco Completa!",
                toast_study_complete_body: "Hora de uma pausa. Bom trabalho!",
                toast_break_over_title: "Pausa Terminada!",
                toast_break_over_body: "Hora de voltar ao foco!",
                toast_long_break_over_title: "Pausa Longa Terminada!",
                toast_long_break_over_body: "Ciclo completo! Pronto para um novo?",
                toast_cycle_complete_title: "Ciclo Completo!",
                toast_cycle_complete_body: "Parab√©ns! Voc√™ completou um ciclo Pomodoro.",
                toast_new_day_title: "Um Novo Dia!",
                toast_new_day_body: "Suas estat√≠sticas di√°rias foram reiniciadas.",
                toast_import_success_title: "Importa√ß√£o Conclu√≠da",
                toast_import_success_body: "Seu progresso foi restaurado. A p√°gina ser√° recarregada.",
                toast_import_error_title: "Falha na Importa√ß√£o",
                toast_import_error_body: "O arquivo selecionado n√£o √© um backup v√°lido ou est√° corrompido.",
                alert_reset_cycle_title: "Confirmar Rein√≠cio",
                alert_reset_cycle_body: "Tem certeza que quer reiniciar o ciclo atual? A sess√£o de foco voltar√° para 1/4.",
                alert_help_title: "Como o Timer Pomodoro Funciona",
                alert_help_body: `<p class="mb-3">A <strong>T√©cnica Pomodoro</strong> √© um m√©todo de gerenciamento de tempo que usa um timer para dividir o trabalho em intervalos, tradicionalmente de 25 minutos, separados por pausas curtas.</p><p class="mb-1 font-semibold">O Ciclo Deste Timer:</p><ul><li>1. Sess√£o de Foco (ex: 25 min)</li><li class="break-session" style="padding-left: 35px;">Pausa Curta (ex: 5 min)</li><li>2. Sess√£o de Foco</li><li class="break-session" style="padding-left: 35px;">Pausa Curta</li><li>3. Sess√£o de Foco</li><li class="break-session" style="padding-left: 35px;">Pausa Curta</li><li>4. Sess√£o de Foco (completa 1 ciclo)</li><li class="break-session" style="padding-left: 35px;">Pausa Longa (ex: 15 min)</li></ul><p class="mb-3">As sess√µes de foco e pausas come√ßam automaticamente. Ap√≥s a pausa longa, no entanto, voc√™ precisar√° iniciar o novo ciclo manualmente.</p><p class="mb-3">A sequ√™ncia de foco s√≥ aumenta ap√≥s completar a primeira sess√£o de foco do dia.</p><p>Reinicie o ciclo usando o bot√£o <i class='fas fa-sync-alt fa-xs'></i>.</p>`,
                alert_import_title: "Importar Progresso?",
                alert_import_body: "Isso ir√° sobrescrever todo o seu progresso, conquistas e configura√ß√µes atuais. Esta a√ß√£o n√£o pode ser desfeita. Voc√™ tem certeza que deseja continuar?",
                achievements: {
                    "days1": {"name":"Iniciante Focado","description":"Complete seu primeiro dia de foco."},
                    "days7": {"name":"Compromisso Semanal","description":"Foque por 7 dias."},
                    "days15": {"name":"Foco Quinzenal","description":"Foque por 15 dias."},
                    "days30": {"name":"Marco Mensal","description":"Foque por 30 dias."},
                    "days50": {"name":"Estrela Cadente","description":"Foque por 50 dias."},
                    "days75": {"name":"Maratonista do Foco","description":"Foque por 75 dias."},
                    "days100": {"name":"Mestre do H√°bito","description":"Foque por 100 dias."},
                    "days120": {"name":"Lenda do Foco","description":"Foque por 120 dias."},
                    "days150": {"name":"S√°bio do Foco","description":"Foque por 150 dias."},
                    "streak3": {"name":"Combo de 3 Dias!","description":"Mantenha 3 dias de foco seguidos."},
                    "streak7": {"name":"Sequ√™ncia Semanal","description":"Mantenha 7 dias de foco seguidos."},
                    "streak14": {"name":"H√°bito Turbinado","description":"Mantenha 14 dias de foco seguidos."},
                    "streak30": {"name":"Impar√°vel","description":"Mantenha 30 dias de foco seguidos."},
                    "streak50": {"name":"Dedica√ß√£o Pura","description":"Mantenha 50 dias de foco seguidos."},
                    "cycles1": {"name":"Primeiro Ciclo","description":"Complete 1 ciclo Pomodoro."},
                    "cycles10": {"name":"Dez Ciclos de Foco","description":"Complete 10 ciclos Pomodoro."},
                    "cycles25": {"name":"Pro da Produtividade","description":"Complete 25 ciclos Pomodoro."},
                    "cycles50": {"name":"Para a Lua","description":"Complete 50 ciclos Pomodoro."},
                    "cycles100": {"name":"Centuri√£o de Ciclos","description":"Complete 100 ciclos Pomodoro."},
                    "hours1": {"name":"Primeira Hora de Foco","description":"Acumule 1 hora de foco puro."},
                    "hours10": {"name":"Pensador Imersivo","description":"Acumule 10 horas de foco puro."},
                    "hours50": {"name":"Fonte de Sabedoria","description":"Acumule 50 horas de foco puro."},
                    "hours100": {"name":"Erudito Puro","description":"Acumule 100 horas de foco puro."},
                    "sb_hours_1": {"name":"Respiro R√°pido","description":"Acumule 1 hora em pausas curtas."},
                    "sb_hours_5": {"name":"Mestre do Relax","description":"Acumule 5 horas em pausas curtas."},
                    "sb_hours_15": {"name":"Campe√£o da Pausa","description":"Acumule 15 horas em pausas curtas."},
                    "lb_hours_3": {"name":"Descanso Merecido","description":"Acumule 3 horas em pausas longas."},
                    "lb_hours_10": {"name":"Mestre da Recarga","description":"Acumule 10 horas em pausas longas."},
                    "lb_hours_25": {"name":"Expert do Lazer","description":"Acumule 25 horas em pausas longas."}
                }
            },
            'es': {
                app_title: "PomodoroCycle Timer",
                help_tooltip: "Ayuda / C√≥mo Usar",
                settings_tooltip: "Ajustes",
                current_timer_label: "Temporizador:",
                mode_study: "Foco",
                mode_short_break: "Pausa Corta",
                mode_long_break: "Pausa Larga",
                cycle_tooltip: "Sesiones de foco en el ciclo actual",
                reset_cycle_tooltip: "Reiniciar Ciclo",
                skip_break_button: "Saltar Pausa",
                start_button: "Empezar",
                pause_button: "Pausar",
                resume_button: "Reanudar",
                reset_current_button: "Reiniciar Actual",
                tab_stats: "Estad√≠sticas",
                tab_rewards: "Recompensas Diarias",
                tab_achievements: "Logros",
                stats_title: "Tus Estad√≠sticas",
                stats_streak: "Racha de Foco",
                stats_daily_title: "Diario:",
                stats_daily_cycles: "Ciclos Completados Hoy",
                stats_daily_study_time: "Tiempo de Foco Puro Hoy",
                stats_daily_total_time: "Tiempo Total Hoy",
                stats_general_title: "General:",
                stats_general_cycles: "Ciclos Totales Completados",
                stats_general_study_time: "Tiempo Total de Foco Puro",
                stats_general_days: "Total de D√≠as de Foco",
                rewards_title: "Gestionar Recompensas",
                rewards_name_placeholder: "Nombre de la recompensa",
                rewards_type_cycles: "Ciclos Completados",
                rewards_type_hours: "Horas de Foco",
                rewards_value_placeholder: "Valor",
                rewards_add_button: "A√±adir",
                rewards_no_rewards: "No hay recompensas configuradas.",
                rewards_goal_label: "Meta",
                rewards_progress_label: "Progreso",
                rewards_earned_today: "¬°Recompensa Obtenida!",
                achievements_title: "Tus Logros",
                storage_warning: "Tu progreso se guarda en el almacenamiento local de tu navegador. Limpiar los datos puede borrar tu progreso.",
                donation_text: "Si quieres apoyar esta app, puedes hacerlo {0}",
                donation_link_text: "aqu√≠ ‚òï",
                settings_title: "Ajustes del Temporizador",
                settings_section_timer: "Duraciones del Temporizador",
                settings_section_prefs: "Preferencias",
                settings_study_time: "Tiempo de Foco (minutos):",
                settings_short_break: "Pausa Corta (minutos):",
                settings_long_break: "Pausa Larga (minutos):",
                settings_language: "Idioma:",
                settings_enable_sounds: "Habilitar Sonidos:",
                settings_data_management: "Gesti√≥n de Datos",
                settings_data_info: "Guarda tu progreso en un archivo o c√°rgalo en otro dispositivo.",
                settings_export_button: "Exportar Datos",
                settings_import_button: "Importar Datos",
                cancel_button: "Cancelar",
                save_button: "Guardar",
                confirm_button: "Confirmar",
                ok_button: "OK",
                got_it_button: "¬°Entendido!",
                new_badge: "¬°NUEVO!",
                unlocked_on_date: "Desbloqueado: {0}",
                progress_label: "Progreso: {0} / {1}",
                toast_error_title: "Error",
                toast_rewards_error: "Por favor, rellena los campos correctamente. El valor debe ser 0 o mayor.",
                toast_settings_saved_title: "Ajustes Guardados",
                toast_settings_saved_body: "Se han aplicado las nuevas duraciones del temporizador.",
                toast_reward_earned_title: "¬°Recompensa Ganada!",
                toast_reward_earned_body: '¬°Has ganado la recompensa: "{0}"!',
                toast_achievement_unlocked_title: "¬°Logro Desbloqueado!",
                toast_achievement_unlocked_body: '¬°Has desbloqueado el logro: "{0}"!',
                toast_study_complete_title: "¬°Sesi√≥n de Foco Completa!",
                toast_study_complete_body: "Es hora de un descanso. ¬°Buen trabajo!",
                toast_break_over_title: "¬°Pausa Terminada!",
                toast_break_over_body: "¬°Es hora de volver a concentrarse!",
                toast_long_break_over_title: "¬°Pausa Larga Terminada!",
                toast_long_break_over_body: "¬°Ciclo completo! ¬øListo para uno nuevo?",
                toast_cycle_complete_title: "¬°Ciclo Completo!",
                toast_cycle_complete_body: "¬°Felicidades! Has completado un ciclo Pomodoro.",
                toast_new_day_title: "¬°Un Nuevo D√≠a!",
                toast_new_day_body: "Tus estad√≠sticas diarias se han reiniciado.",
                toast_import_success_title: "Importaci√≥n Exitosa",
                toast_import_success_body: "Tu progreso ha sido restaurado. La p√°gina se recargar√° ahora.",
                toast_import_error_title: "Fall√≥ la Importaci√≥n",
                toast_import_error_body: "El archivo seleccionado no es un archivo de respaldo v√°lido o est√° da√±ado.",
                alert_reset_cycle_title: "Confirmar Reinicio",
                alert_reset_cycle_body: "¬øSeguro que quieres reiniciar el ciclo actual? La sesi√≥n de foco volver√° a 1/4.",
                alert_help_title: "C√≥mo Funciona el Temporizador Pomodoro",
                alert_help_body: `<p class="mb-3">La <strong>T√©cnica Pomodoro</strong> es un m√©todo de gesti√≥n del tiempo que utiliza un temporizador para dividir el trabajo en intervalos, tradicionalmente de 25 minutos, separados por pausas cortas.</p><p class="mb-1 font-semibold">El Ciclo de Este Temporizador:</p><ul><li>1. Sesi√≥n de Foco (ej. 25 min)</li><li class="break-session" style="padding-left: 35px;">Pausa Corta (ej. 5 min)</li><li>2. Sesi√≥n de Foco</li><li class="break-session" style="padding-left: 35px;">Pausa Corta</li><li>3. Sesi√≥n de Foco</li><li class="break-session" style="padding-left: 35px;">Pausa Corta</li><li>4. Sesi√≥n de Foco (completa 1 ciclo)</li><li class="break-session" style="padding-left: 35px;">Pausa Larga (ej. 15 min)</li></ul><p class="mb-3">Las sesiones de foco y las pausas comienzan autom√°ticamente. Sin embargo, despu√©s de la pausa larga, deber√°s iniciar el nuevo ciclo manualmente.</p><p class="mb-3">La racha de foco solo aumenta despu√©s de completar la primera sesi√≥n de foco del d√≠a.</p><p>Reinicia el ciclo usando el bot√≥n <i class='fas fa-sync-alt fa-xs'></i>.</p>`,
                alert_import_title: "¬øImportar Progreso?",
                alert_import_body: "Esto sobrescribir√° todo tu progreso, logros y ajustes actuales. Esta acci√≥n no se puede deshacer. ¬øEst√°s seguro de que quieres continuar?",
                achievements: {
                    "days1": {"name":"Principiante Centrado","description":"Completa tu primer d√≠a de foco."},
                    "days7": {"name":"Compromiso Semanal","description":"Enf√≥cate durante 7 d√≠as."},
                    "days15": {"name":"Enfoque Quincenal","description":"Enf√≥cate durante 15 d√≠as."},
                    "days30": {"name":"Hito Mensual","description":"Enf√≥cate durante 30 d√≠as."},
                    "days50": {"name":"Estrella Fugaz","description":"Enf√≥cate durante 50 d√≠as."},
                    "days75": {"name":"Maratonista del Foco","description":"Enf√≥cate durante 75 d√≠as."},
                    "days100": {"name":"Maestro del H√°bito","description":"Enf√≥cate durante 100 d√≠as."},
                    "days120": {"name":"Leyenda del Enfoque","description":"Enf√≥cate durante 120 d√≠as."},
                    "days150": {"name":"Sabio del Foco","description":"Enf√≥cate durante 150 d√≠as."},
                    "streak3": {"name":"¬°Combo de 3 D√≠as!","description":"Mant√©n una racha de foco de 3 d√≠as."},
                    "streak7": {"name":"Racha de una Semana","description":"Mant√©n una racha de foco de 7 d√≠as."},
                    "streak14": {"name":"H√°bito Potenciado","description":"Mant√©n una racha de foco de 14 d√≠as."},
                    "streak30": {"name":"Imparable","description":"Mant√©n una racha de foco de 30 d√≠as."},
                    "streak50": {"name":"Dedicaci√≥n Verdadera","description":"Mant√©n una racha de foco de 50 d√≠as."},
                    "cycles1": {"name":"Primer Ciclo Completo","description":"Completa 1 ciclo Pomodoro."},
                    "cycles10": {"name":"Diez Ciclos de Foco","description":"Completa 10 ciclos Pomodoro."},
                    "cycles25": {"name":"Pro de Productividad","description":"Completa 25 ciclos Pomodoro."},
                    "cycles50": {"name":"Hacia la Luna","description":"Completa 50 ciclos Pomodoro."},
                    "cycles100": {"name":"Centuri√≥n de Ciclos","description":"Completa 100 ciclos Pomodoro."},
                    "hours1": {"name":"Primera Hora de Foco","description":"Acumula 1 hora de foco puro."},
                    "hours10": {"name":"Pensador Inmersivo","description":"Acumula 10 horas de foco puro."},
                    "hours50": {"name":"Fuente de Saber","description":"Acumula 50 horas de foco puro."},
                    "hours100": {"name":"Erudito del Foco","description":"Acumula 100 horas de foco puro."},
                    "sb_hours_1": {"name":"Respiro R√°pido","description":"Acumula 1 hora em pausas cortas."},
                    "sb_hours_5": {"name":"Experto en Relajo","description":"Acumula 5 horas em pausas cortas."},
                    "sb_hours_15": {"name":"Campe√≥n del Descanso","description":"Acumula 15 horas em pausas cortas."},
                    "lb_hours_3": {"name":"Descanso Merecido","description":"Acumula 3 horas em pausas largas."},
                    "lb_hours_10": {"name":"Maestro de Recarga","description":"Acumula 10 horas em pausas largas."},
                    "lb_hours_25": {"name":"Experto del Ocio","description":"Acumula 25 horas em pausas largas."}
                }
            },
            'zh-CN': {
                app_title: "Áï™ËåÑÂë®ÊúüËÆ°Êó∂Âô®",
                help_tooltip: "Â∏ÆÂä© / Â¶Ç‰Ωï‰ΩøÁî®",
                settings_tooltip: "ËÆæÁΩÆ",
                current_timer_label: "ÂΩìÂâçËÆ°Êó∂:",
                mode_study: "‰∏ìÊ≥®",
                mode_short_break: "Áü≠ÊöÇ‰ºëÊÅØ",
                mode_long_break: "ÈïøÊó∂Èó¥‰ºëÊÅØ",
                cycle_tooltip: "ÂΩìÂâçÂë®ÊúüÁöÑ‰∏ìÊ≥®Ê¨°Êï∞",
                reset_cycle_tooltip: "ÈáçÁΩÆÂë®Êúü",
                skip_break_button: "Ë∑≥Ëøá‰ºëÊÅØ",
                start_button: "ÂºÄÂßã",
                pause_button: "ÊöÇÂÅú",
                resume_button: "ÁªßÁª≠",
                reset_current_button: "ÈáçÁΩÆÂΩìÂâç",
                tab_stats: "ÁªüËÆ°",
                tab_rewards: "ÊØèÊó•Â•ñÂä±",
                tab_achievements: "ÊàêÂ∞±",
                stats_title: "ÊÇ®ÁöÑÁªüËÆ°Êï∞ÊçÆ",
                stats_streak: "‰∏ìÊ≥®ËøûËÉú",
                stats_daily_title: "ÊØèÊó•:",
                stats_daily_cycles: "‰ªäÊó•ÂÆåÊàêÂë®Êúü",
                stats_daily_study_time: "‰ªäÊó•Á∫Ø‰∏ìÊ≥®Êó∂Èó¥",
                stats_daily_total_time: "‰ªäÊó•ÊÄªÊó∂Èó¥",
                stats_general_title: "ÊÄªËÆ°:",
                stats_general_cycles: "ÊÄªÂÆåÊàêÂë®Êúü",
                stats_general_study_time: "ÊÄªÁ∫Ø‰∏ìÊ≥®Êó∂Èó¥",
                stats_general_days: "ÊÄª‰∏ìÊ≥®Â§©Êï∞",
                rewards_title: "ÁÆ°ÁêÜÊØèÊó•Â•ñÂä±",
                rewards_name_placeholder: "Â•ñÂä±ÂêçÁß∞",
                rewards_type_cycles: "ÂÆåÊàêÁöÑÂë®Êúü",
                rewards_type_hours: "‰∏ìÊ≥®Â∞èÊó∂",
                rewards_value_placeholder: "Êï∞ÂÄº",
                rewards_add_button: "Ê∑ªÂä†Â•ñÂä±",
                rewards_no_rewards: "Êú™ÈÖçÁΩÆÂ•ñÂä±„ÄÇ",
                rewards_goal_label: "ÁõÆÊ†á",
                rewards_progress_label: "ËøõÂ∫¶",
                rewards_earned_today: "‰ªäÊó•Â∑≤Ëé∑ÂæóÂ•ñÂä±ÔºÅ",
                achievements_title: "ÊÇ®ÁöÑÊàêÂ∞±",
                storage_warning: "ÊÇ®ÁöÑËøõÂ∫¶‰øùÂ≠òÂú®ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®‰∏≠„ÄÇÊ∏ÖÈô§ÊµèËßàÂô®Êï∞ÊçÆÂèØËÉΩ‰ºöÂà†Èô§ÊÇ®ÁöÑËøõÂ∫¶„ÄÇ",
                donation_text: "Â¶ÇÊûúÊÇ®ÊÉ≥ÊîØÊåÅËøô‰∏™Â∫îÁî®ÔºåÂèØ‰ª•{0}",
                donation_link_text: "Âú®ËøôÈáå ‚òï",
                settings_title: "ËÆ°Êó∂Âô®ËÆæÁΩÆ",
                settings_section_timer: "ËÆ°Êó∂Âô®Êó∂Èïø",
                settings_section_prefs: "ÂÅèÂ•ΩËÆæÁΩÆ",
                settings_study_time: "‰∏ìÊ≥®Êó∂Èó¥ (ÂàÜÈíü):",
                settings_short_break: "Áü≠ÊöÇ‰ºëÊÅØ (ÂàÜÈíü):",
                settings_long_break: "ÈïøÊó∂Èó¥‰ºëÊÅØ (ÂàÜÈíü):",
                settings_language: "ËØ≠Ë®Ä:",
                settings_enable_sounds: "ÂêØÁî®Â£∞Èü≥:",
                settings_data_management: "Êï∞ÊçÆÁÆ°ÁêÜ",
                settings_data_info: "Â∞ÜÊÇ®ÁöÑËøõÂ∫¶‰øùÂ≠òÂà∞Êñá‰ª∂ÊàñÂú®ÂÖ∂‰ªñËÆæÂ§á‰∏äÂä†ËΩΩ„ÄÇ",
                settings_export_button: "ÂØºÂá∫Êï∞ÊçÆ",
                settings_import_button: "ÂØºÂÖ•Êï∞ÊçÆ",
                cancel_button: "ÂèñÊ∂à",
                save_button: "‰øùÂ≠òËÆæÁΩÆ",
                confirm_button: "Á°ÆËÆ§",
                ok_button: "Â•ΩÁöÑ",
                got_it_button: "Áü•ÈÅì‰∫Ü!",
                new_badge: "Êñ∞ÔºÅ",
                unlocked_on_date: "Ëß£ÈîÅ‰∫é: {0}",
                progress_label: "ËøõÂ∫¶: {0} / {1}",
                toast_error_title: "ÈîôËØØ",
                toast_rewards_error: "ËØ∑Ê≠£Á°ÆÂ°´ÂÜôÊâÄÊúâÂ•ñÂä±Â≠óÊÆµ„ÄÇÊï∞ÂÄºÂøÖÈ°ªÂ§ß‰∫éÊàñÁ≠â‰∫é0„ÄÇ",
                toast_settings_saved_title: "ËÆæÁΩÆÂ∑≤‰øùÂ≠ò",
                toast_settings_saved_body: "Êñ∞ÁöÑËÆ°Êó∂Âô®Êó∂ÈïøÂ∑≤Â∫îÁî®„ÄÇ",
                toast_reward_earned_title: "Ëé∑ÂæóÂ•ñÂä±ÔºÅ",
                toast_reward_earned_body: 'ÊÇ®Ëé∑Âæó‰∫ÜÂ•ñÂä±Ôºö‚Äú{0}‚ÄùÔºÅ',
                toast_achievement_unlocked_title: "ÊàêÂ∞±Â∑≤Ëß£ÈîÅÔºÅ",
                toast_achievement_unlocked_body: 'ÊÇ®Ëß£ÈîÅ‰∫ÜÊàêÂ∞±Ôºö‚Äú{0}‚ÄùÔºÅ',
                toast_study_complete_title: "‰∏ìÊ≥®Êó∂ÊÆµÂÆåÊàêÔºÅ",
                toast_study_complete_body: "ËØ•‰ºëÊÅØ‰∫Ü„ÄÇÂÅöÂæóÂ•ΩÔºÅ",
                toast_break_over_title: "‰ºëÊÅØÁªìÊùüÔºÅ",
                toast_break_over_body: "ËØ•ÂõûÂéª‰∏ìÊ≥®‰∫ÜÔºÅ",
                toast_long_break_over_title: "ÈïøÊó∂Èó¥‰ºëÊÅØÁªìÊùüÔºÅ",
                toast_long_break_over_body: "Âë®ÊúüÂÆåÊàêÔºÅÂáÜÂ§áÂ•ΩÂºÄÂßãÊñ∞ÁöÑÂë®Êúü‰∫ÜÂêóÔºü",
                toast_cycle_complete_title: "Âë®ÊúüÂÆåÊàêÔºÅ",
                toast_cycle_complete_body: "ÊÅ≠ÂñúÔºÅÊÇ®ÂÆåÊàê‰∫Ü‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÁï™ËåÑÂë®Êúü„ÄÇ",
                toast_new_day_title: "Êñ∞ÁöÑ‰∏ÄÂ§©ÔºÅ",
                toast_new_day_body: "ÊÇ®ÁöÑÊØèÊó•ÁªüËÆ°Êï∞ÊçÆÂ∑≤ÈáçÁΩÆ„ÄÇ",
                toast_import_success_title: "ÂØºÂÖ•ÊàêÂäü",
                toast_import_success_body: "ÊÇ®ÁöÑËøõÂ∫¶Â∑≤ÊÅ¢Â§ç„ÄÇÈ°µÈù¢Âç≥Â∞ÜÈáçÊñ∞Âä†ËΩΩ„ÄÇ",
                toast_import_error_title: "ÂØºÂÖ•Â§±Ë¥•",
                toast_import_error_body: "ÊâÄÈÄâÊñá‰ª∂‰∏çÊòØÊúâÊïàÁöÑÂ§á‰ªΩÊñá‰ª∂ÊàñÂ∑≤ÊçüÂùè„ÄÇ",
                alert_reset_cycle_title: "Á°ÆËÆ§ÈáçÁΩÆ",
                alert_reset_cycle_body: "ÊÇ®Á°ÆÂÆöË¶ÅÈáçÁΩÆÂΩìÂâçÂë®ÊúüÂêóÔºüËøôÂ∞ÜÊää‰∏ìÊ≥®Êó∂ÊÆµËÆæÁΩÆ‰∏∫1/4„ÄÇ",
                alert_help_title: "Áï™ËåÑÂ∑•‰ΩúÊ≥ïËÆ°Êó∂Âô®Â¶Ç‰ΩïÂ∑•‰Ωú",
                alert_help_body: `<p class="mb-3"><strong>Áï™ËåÑÂ∑•‰ΩúÊ≥ï</strong>ÊòØ‰∏ÄÁßçÊó∂Èó¥ÁÆ°ÁêÜÊñπÊ≥ïÔºåÂÆÉ‰ΩøÁî®ËÆ°Êó∂Âô®Â∞ÜÂ∑•‰ΩúÂàÜËß£‰∏∫Â§ö‰∏™Êó∂Èó¥Èó¥ÈöîÔºå‰º†Áªü‰∏ä‰∏∫25ÂàÜÈíüÔºå‰∏≠Èó¥Á©øÊèíÁü≠ÊöÇ‰ºëÊÅØ„ÄÇ</p><p class="mb-1 font-semibold">Ê≠§ËÆ°Êó∂Âô®ÁöÑÂë®ÊúüÔºö</p><ul><li>1. ‰∏ìÊ≥®Êó∂ÊÆµ (‰æãÂ¶Ç 25 ÂàÜÈíü)</li><li class="break-session" style="padding-left: 35px;">Áü≠ÊöÇ‰ºëÊÅØ (‰æãÂ¶Ç 5 ÂàÜÈíü)</li><li>2. ‰∏ìÊ≥®Êó∂ÊÆµ</li><li class="break-session" style="padding-left: 35px;">Áü≠ÊöÇ‰ºëÊÅØ</li><li>3. ‰∏ìÊ≥®Êó∂ÊÆµ</li><li class="break-session" style="padding-left: 35px;">Áü≠ÊöÇ‰ºëÊÅØ</li><li>4. ‰∏ìÊ≥®Êó∂ÊÆµ (ÂÆåÊàê1‰∏™Âë®Êúü)</li><li class="break-session" style="padding-left: 35px;">ÈïøÊó∂Èó¥‰ºëÊÅØ (‰æãÂ¶Ç 15 ÂàÜÈíü)</li></ul><p class="mb-3">‰∏ìÊ≥®Âíå‰ºëÊÅØÊó∂ÊÆµ‰ºöËá™Âä®ÂºÄÂßã„ÄÇ‰ΩÜÂú®ÈïøÊó∂Èó¥‰ºëÊÅØÂêéÔºåÊÇ®ÈúÄË¶ÅÊâãÂä®ÂºÄÂßãÊñ∞ÁöÑÂë®Êúü„ÄÇ</p><p class="mb-3">Âè™ÊúâÂú®ÂÆåÊàêÂΩìÂ§©ÁöÑÁ¨¨‰∏ÄÊ¨°‰∏ìÊ≥®ÂêéÔºå‰∏ìÊ≥®ËøûËÉúÊâç‰ºöÂ¢ûÂä†„ÄÇ</p><p>‰ΩøÁî® <i class='fas fa-sync-alt fa-xs'></i> ÊåâÈíÆÈáçÁΩÆÂë®Êúü„ÄÇ</p>`,
                alert_import_title: "ÂØºÂÖ•ËøõÂ∫¶Ôºü",
                alert_import_body: "ËøôÂ∞ÜË¶ÜÁõñÊÇ®ÂΩìÂâçÁöÑÊâÄÊúâËøõÂ∫¶„ÄÅÊàêÂ∞±ÂíåËÆæÁΩÆ„ÄÇÊ≠§Êìç‰ΩúÊó†Ê≥ïÊí§ÈîÄ„ÄÇÊÇ®Á°ÆÂÆöË¶ÅÁªßÁª≠ÂêóÔºü",
                achievements: {
                    "days1": {"name":"‰∏ìÊ≥®ÂàùÂ≠¶ËÄÖ","description":"ÂÆåÊàêÁ¨¨‰∏ÄÂ§©ÁöÑ‰∏ìÊ≥®„ÄÇ"},
                    "days7": {"name":"ÊØèÂë®ÊâøËØ∫","description":"‰∏ìÊ≥®7Â§©„ÄÇ"},
                    "days15": {"name":"‰∏§Âë®‰∏ìÊ≥®","description":"‰∏ìÊ≥®15Â§©„ÄÇ"},
                    "days30": {"name":"ÊúàÂ∫¶ÈáåÁ®ãÁ¢ë","description":"‰∏ìÊ≥®30Â§©„ÄÇ"},
                    "days50": {"name":"ÊµÅÊòü","description":"‰∏ìÊ≥®50Â§©„ÄÇ"},
                    "days75": {"name":"‰∏ìÊ≥®È©¨ÊãâÊùæ","description":"‰∏ìÊ≥®75Â§©„ÄÇ"},
                    "days100": {"name":"‰π†ÊÉØÂ§ßÂ∏à","description":"‰∏ìÊ≥®100Â§©„ÄÇ"},
                    "days120": {"name":"‰∏ìÊ≥®‰º†Â•á","description":"‰∏ìÊ≥®120Â§©„ÄÇ"},
                    "days150": {"name":"‰∏ìÊ≥®Âú£‰∫∫","description":"‰∏ìÊ≥®150Â§©„ÄÇ"},
                    "streak3": {"name":"3Â§©ËøûÂáªÔºÅ","description":"‰øùÊåÅ3Â§©ÁöÑ‰∏ìÊ≥®ËøûËÉú„ÄÇ"},
                    "streak7": {"name":"‰∏ÄÂë®ËøûËÉú","description":"‰øùÊåÅ7Â§©ÁöÑ‰∏ìÊ≥®ËøûËÉú„ÄÇ"},
                    "streak14": {"name":"‰π†ÊÉØÂº∫Âåñ","description":"‰øùÊåÅ14Â§©ÁöÑ‰∏ìÊ≥®ËøûËÉú„ÄÇ"},
                    "streak30": {"name":"Âäø‰∏çÂèØÊå°","description":"‰øùÊåÅ30Â§©ÁöÑ‰∏ìÊ≥®ËøûËÉú„ÄÇ"},
                    "streak50": {"name":"ÁúüÊ≠£ÊäïÂÖ•","description":"‰øùÊåÅ50Â§©ÁöÑ‰∏ìÊ≥®ËøûËÉú„ÄÇ"},
                    "cycles1": {"name":"È¶ñ‰∏™ÂÆåÊï¥Âë®Êúü","description":"ÂÆåÊàê1‰∏™Áï™ËåÑÂë®Êúü„ÄÇ"},
                    "cycles10": {"name":"ÂçÅËΩÆ‰∏ìÊ≥®","description":"ÂÆåÊàê10‰∏™Áï™ËåÑÂë®Êúü„ÄÇ"},
                    "cycles25": {"name":"ÊïàÁéá‰∏ìÂÆ∂","description":"ÂÆåÊàê25‰∏™Áï™ËåÑÂë®Êúü„ÄÇ"},
                    "cycles50": {"name":"È£ûÂêëÊúàÁêÉ","description":"ÂÆåÊàê50‰∏™Áï™ËåÑÂë®Êúü„ÄÇ"},
                    "cycles100": {"name":"Âë®ÊúüÁôæÂ§´Èïø","description":"ÂÆåÊàê100‰∏™Áï™ËåÑÂë®Êúü„ÄÇ"},
                    "hours1": {"name":"‰∏ìÊ≥®‰∏ÄÂ∞èÊó∂","description":"Á¥ØËÆ°1Â∞èÊó∂ÁöÑÁ∫Ø‰∏ìÊ≥®„ÄÇ"},
                    "hours10": {"name":"Ê≤âÊµ∏ÊÄùËÄÉËÄÖ","description":"Á¥ØËÆ°10Â∞èÊó∂ÁöÑÁ∫Ø‰∏ìÊ≥®„ÄÇ"},
                    "hours50": {"name":"Áü•ËØÜÊ∫êÊ≥â","description":"Á¥ØËÆ°50Â∞èÊó∂ÁöÑÁ∫Ø‰∏ìÊ≥®„ÄÇ"},
                    "hours100": {"name":"‰∏ìÊ≥®Â≠¶ËÄÖ","description":"Á¥ØËÆ°100Â∞èÊó∂ÁöÑÁ∫Ø‰∏ìÊ≥®„ÄÇ"},
                    "sb_hours_1": {"name":"Âø´ÈÄüÂñòÊÅØ","description":"Á¥ØËÆ°1Â∞èÊó∂ÁöÑÁü≠ÊöÇ‰ºëÊÅØ„ÄÇ"},
                    "sb_hours_5": {"name":"ÊîæÊùæËææ‰∫∫","description":"Á¥ØËÆ°5Â∞èÊó∂ÁöÑÁü≠ÊöÇ‰ºëÊÅØ„ÄÇ"},
                    "sb_hours_15": {"name":"Áü≠‰ºëÂÜ†ÂÜõ","description":"Á¥ØËÆ°15Â∞èÊó∂ÁöÑÁü≠ÊöÇ‰ºëÊÅØ„ÄÇ"},
                    "lb_hours_3": {"name":"Â∫îÂæóÁöÑ‰ºëÊÅØ","description":"Á¥ØËÆ°3Â∞èÊó∂ÁöÑÈïøÊó∂Èó¥‰ºëÊÅØ„ÄÇ"},
                    "lb_hours_10": {"name":"ÂÖÖÁîµÂ§ßÂ∏à","description":"Á¥ØËÆ°10Â∞èÊó∂ÁöÑÈïøÊó∂Èó¥‰ºëÊÅØ„ÄÇ"},
                    "lb_hours_25": {"name":"‰ºëÈó≤‰∏ìÂÆ∂","description":"Á¥ØËÆ°25Â∞èÊó∂ÁöÑÈïøÊó∂Èó¥‰ºëÊÅØ„ÄÇ"}
                }
            },
            'hi-IN': {
                app_title: "‡§™‡•ã‡§Æ‡•ã‡§°‡•ã‡§∞‡•ã ‡§∏‡§æ‡§á‡§ï‡§ø‡§≤ ‡§ü‡§æ‡§á‡§Æ‡§∞",
                help_tooltip: "‡§∏‡§π‡§æ‡§Ø‡§§‡§æ / ‡§ï‡•à‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç",
                settings_tooltip: "‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏",
                current_timer_label: "‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§ü‡§æ‡§á‡§Æ‡§∞:",
                mode_study: "‡§´‡•ã‡§ï‡§∏",
                mode_short_break: "‡§õ‡•ã‡§ü‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï",
                mode_long_break: "‡§≤‡§Ç‡§¨‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï",
                cycle_tooltip: "‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§ö‡§ï‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§´‡•ã‡§ï‡§∏ ‡§∏‡§§‡•ç‡§∞",
                reset_cycle_tooltip: "‡§ö‡§ï‡•ç‡§∞ ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
                skip_break_button: "‡§¨‡•ç‡§∞‡•á‡§ï ‡§õ‡•ã‡§°‡§º‡•á‡§Ç",
                start_button: "‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç",
                pause_button: "‡§∞‡•ã‡§ï‡•á‡§Ç",
                resume_button: "‡§´‡§ø‡§∞ ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç",
                reset_current_button: "‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
                tab_stats: "‡§Ü‡§Å‡§ï‡§°‡§º‡•á",
                tab_rewards: "‡§¶‡•à‡§®‡§ø‡§ï ‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞",
                tab_achievements: "‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø‡§Ø‡§æ‡§Ç",
                stats_title: "‡§Ü‡§™‡§ï‡•á ‡§Ü‡§Å‡§ï‡§°‡§º‡•á",
                stats_streak: "‡§´‡•ã‡§ï‡§∏ ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ï",
                stats_daily_title: "‡§¶‡•à‡§®‡§ø‡§ï:",
                stats_daily_cycles: "‡§Ü‡§ú ‡§™‡•Ç‡§∞‡•á ‡§π‡•Å‡§è ‡§ö‡§ï‡•ç‡§∞",
                stats_daily_study_time: "‡§Ü‡§ú ‡§ï‡§æ ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§´‡•ã‡§ï‡§∏ ‡§∏‡§Æ‡§Ø",
                stats_daily_total_time: "‡§Ü‡§ú ‡§ï‡§æ ‡§ï‡•Å‡§≤ ‡§∏‡§Æ‡§Ø",
                stats_general_title: "‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø:",
                stats_general_cycles: "‡§ï‡•Å‡§≤ ‡§™‡•Ç‡§∞‡•á ‡§π‡•Å‡§è ‡§ö‡§ï‡•ç‡§∞",
                stats_general_study_time: "‡§ï‡•Å‡§≤ ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§´‡•ã‡§ï‡§∏ ‡§∏‡§Æ‡§Ø",
                stats_general_days: "‡§ï‡•Å‡§≤ ‡§´‡•ã‡§ï‡§∏ ‡§ï‡•á ‡§¶‡§ø‡§®",
                rewards_title: "‡§¶‡•à‡§®‡§ø‡§ï ‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç",
                rewards_name_placeholder: "‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ",
                rewards_type_cycles: "‡§™‡•Ç‡§∞‡•á ‡§π‡•Å‡§è ‡§ö‡§ï‡•ç‡§∞",
                rewards_type_hours: "‡§´‡•ã‡§ï‡§∏ ‡§ï‡•á ‡§ò‡§Ç‡§ü‡•á",
                rewards_value_placeholder: "‡§Æ‡§æ‡§®",
                rewards_add_button: "‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                rewards_no_rewards: "‡§ï‡•ã‡§à ‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞ ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§",
                rewards_goal_label: "‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø",
                rewards_progress_label: "‡§™‡•ç‡§∞‡§ó‡§§‡§ø",
                rewards_earned_today: "‡§Ü‡§ú ‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞ ‡§Ö‡§∞‡•ç‡§ú‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ!",
                achievements_title: "‡§Ü‡§™‡§ï‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø‡§Ø‡§æ‡§Ç",
                storage_warning: "‡§Ü‡§™‡§ï‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§Ü‡§™‡§ï‡•á ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§ï‡•á ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§≠‡§Ç‡§°‡§æ‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§∏‡§π‡•á‡§ú‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§°‡•á‡§ü‡§æ ‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§Ü‡§™‡§ï‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§π‡§ü ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§",
                donation_text: "‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§á‡§∏ ‡§ê‡§™ ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§Ü‡§™ {0} ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç",
                donation_link_text: "‡§Ø‡§π‡§æ‡§Ç ‚òï",
                settings_title: "‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏",
                settings_section_timer: "‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§Ö‡§µ‡§ß‡§ø",
                settings_section_prefs: "‡§µ‡§∞‡•Ä‡§Ø‡§§‡§æ‡§è‡§Å",
                settings_study_time: "‡§´‡•ã‡§ï‡§∏ ‡§∏‡§Æ‡§Ø (‡§Æ‡§ø‡§®‡§ü):",
                settings_short_break: "‡§õ‡•ã‡§ü‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï (‡§Æ‡§ø‡§®‡§ü):",
                settings_long_break: "‡§≤‡§Ç‡§¨‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï (‡§Æ‡§ø‡§®‡§ü):",
                settings_language: "‡§≠‡§æ‡§∑‡§æ:",
                settings_enable_sounds: "‡§ß‡•ç‡§µ‡§®‡§ø ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡•á‡§Ç:",
                settings_data_management: "‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®",
                settings_data_info: "‡§Ö‡§™‡§®‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§ï‡•ã ‡§è‡§ï ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§∏‡§π‡•á‡§ú‡•á‡§Ç ‡§Ø‡§æ ‡§á‡§∏‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§Ö‡§®‡•ç‡§Ø ‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§™‡§∞ ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§",
                settings_export_button: "‡§°‡•á‡§ü‡§æ ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç",
                settings_import_button: "‡§°‡•á‡§ü‡§æ ‡§Ü‡§Ø‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç",
                cancel_button: "‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
                save_button: "‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§∏‡§π‡•á‡§ú‡•á‡§Ç",
                confirm_button: "‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç",
                ok_button: "‡§†‡•Ä‡§ï ‡§π‡•à",
                got_it_button: "‡§∏‡§Æ‡§ù ‡§ó‡§Ø‡§æ!",
                new_badge: "‡§®‡§Ø‡§æ!",
                unlocked_on_date: "‡§Ö‡§®‡§≤‡•â‡§ï ‡§π‡•Å‡§Ü: {0}",
                progress_label: "‡§™‡•ç‡§∞‡§ó‡§§‡§ø: {0} / {1}",
                toast_error_title: "‡§§‡•ç‡§∞‡•Å‡§ü‡§ø",
                toast_rewards_error: "‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞ ‡§´‡§º‡•Ä‡§≤‡•ç‡§° ‡§∏‡§π‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§≠‡§∞‡•á‡§Ç‡•§ ‡§Æ‡§æ‡§® 0 ‡§Ø‡§æ ‡§Ö‡§ß‡§ø‡§ï ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§",
                toast_settings_saved_title: "‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§∏‡§π‡•á‡§ú‡•Ä ‡§ó‡§à‡§Ç",
                toast_settings_saved_body: "‡§Ü‡§™‡§ï‡•Ä ‡§®‡§à ‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§Ö‡§µ‡§ß‡§ø ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞ ‡§¶‡•Ä ‡§ó‡§à ‡§π‡•à‡•§",
                toast_reward_earned_title: "‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞ ‡§Ö‡§∞‡•ç‡§ú‡§ø‡§§!",
                toast_reward_earned_body: '‡§Ü‡§™‡§®‡•á ‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞ ‡§Ö‡§∞‡•ç‡§ú‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ: "{0}"!',
                toast_achievement_unlocked_title: "‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø ‡§Ö‡§®‡§≤‡•â‡§ï!",
                toast_achievement_unlocked_body: '‡§Ü‡§™‡§®‡•á ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡•Ä: "{0}"!',
                toast_study_complete_title: "‡§´‡•ã‡§ï‡§∏ ‡§∏‡§§‡•ç‡§∞ ‡§™‡•Ç‡§∞‡§æ!",
                toast_study_complete_body: "‡§¨‡•ç‡§∞‡•á‡§ï ‡§ï‡§æ ‡§∏‡§Æ‡§Ø‡•§ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§ï‡§æ‡§Æ!",
                toast_break_over_title: "‡§¨‡•ç‡§∞‡•á‡§ï ‡§ñ‡§§‡•ç‡§Æ!",
                toast_break_over_body: "‡§´‡•ã‡§ï‡§∏ ‡§™‡§∞ ‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§®‡•á ‡§ï‡§æ ‡§∏‡§Æ‡§Ø!",
                toast_long_break_over_title: "‡§≤‡§Ç‡§¨‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï ‡§ñ‡§§‡•ç‡§Æ!",
                toast_long_break_over_body: "‡§ö‡§ï‡•ç‡§∞ ‡§™‡•Ç‡§∞‡§æ! ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§®‡§è ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç?",
                toast_cycle_complete_title: "‡§ö‡§ï‡•ç‡§∞ ‡§™‡•Ç‡§∞‡§æ!",
                toast_cycle_complete_body: "‡§¨‡§ß‡§æ‡§à ‡§π‡•ã! ‡§Ü‡§™‡§®‡•á ‡§è‡§ï ‡§™‡•Ç‡§∞‡§æ ‡§™‡•ã‡§Æ‡•ã‡§°‡•ã‡§∞‡•ã ‡§ö‡§ï‡•ç‡§∞ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞ ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à‡•§",
                toast_new_day_title: "‡§è‡§ï ‡§®‡§Ø‡§æ ‡§¶‡§ø‡§®!",
                toast_new_day_body: "‡§Ü‡§™‡§ï‡•á ‡§¶‡•à‡§®‡§ø‡§ï ‡§Ü‡§Å‡§ï‡§°‡§º‡•á ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§¶‡§ø‡§è ‡§ó‡§è ‡§π‡•à‡§Ç‡•§",
                toast_import_success_title: "‡§Ü‡§Ø‡§æ‡§§ ‡§∏‡§´‡§≤",
                toast_import_success_body: "‡§Ü‡§™‡§ï‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§¨‡§π‡§æ‡§≤ ‡§ï‡§∞ ‡§¶‡•Ä ‡§ó‡§à ‡§π‡•à‡•§ ‡§™‡•É‡§∑‡•ç‡§† ‡§Ö‡§¨ ‡§™‡•Å‡§®‡§É ‡§≤‡•ã‡§° ‡§π‡•ã‡§ó‡§æ‡•§",
                toast_import_error_title: "‡§Ü‡§Ø‡§æ‡§§ ‡§µ‡§ø‡§´‡§≤",
                toast_import_error_body: "‡§ö‡§Ø‡§®‡§ø‡§§ ‡§´‡§º‡§æ‡§á‡§≤ ‡§è‡§ï ‡§µ‡•à‡§ß ‡§¨‡•à‡§ï‡§Ö‡§™ ‡§´‡§º‡§æ‡§á‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§Ø‡§æ ‡§¶‡•Ç‡§∑‡§ø‡§§ ‡§π‡•à‡•§",
                alert_reset_cycle_title: "‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç",
                alert_reset_cycle_body: "‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§ö‡§ï‡•ç‡§∞ ‡§ï‡•ã ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç? ‡§Ø‡§π ‡§´‡•ã‡§ï‡§∏ ‡§∏‡§§‡•ç‡§∞ ‡§ï‡•ã 1/4 ‡§™‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§¶‡•á‡§ó‡§æ‡•§",
                alert_help_title: "‡§Ø‡§π ‡§™‡•ã‡§Æ‡•ã‡§°‡•ã‡§∞‡•ã ‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§ï‡•à‡§∏‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à",
                alert_help_body: `<p class="mb-3"><strong>‡§™‡•ã‡§Æ‡•ã‡§°‡•ã‡§∞‡•ã ‡§§‡§ï‡§®‡•Ä‡§ï</strong> ‡§è‡§ï ‡§∏‡§Æ‡§Ø ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§™‡§¶‡•ç‡§ß‡§§‡§ø ‡§π‡•à ‡§ú‡•ã ‡§ï‡§æ‡§Æ ‡§ï‡•ã ‡§Ö‡§Ç‡§§‡§∞‡§æ‡§≤ ‡§Æ‡•á‡§Ç ‡§§‡•ã‡§°‡§º‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à, ‡§™‡§æ‡§∞‡§Ç‡§™‡§∞‡§ø‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á 25 ‡§Æ‡§ø‡§®‡§ü ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à ‡§Æ‡•á‡§Ç, ‡§õ‡•ã‡§ü‡•á ‡§¨‡•ç‡§∞‡•á‡§ï ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Ö‡§≤‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§</p><p class="mb-1 font-semibold">‡§á‡§∏ ‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§ï‡§æ ‡§ö‡§ï‡•ç‡§∞:</p><ul><li>1. ‡§´‡•ã‡§ï‡§∏ ‡§∏‡§§‡•ç‡§∞ (‡§â‡§¶‡§æ. 25 ‡§Æ‡§ø‡§®‡§ü)</li><li class="break-session" style="padding-left: 35px;">‡§õ‡•ã‡§ü‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï (‡§â‡§¶‡§æ. 5 ‡§Æ‡§ø‡§®‡§ü)</li><li>2. ‡§´‡•ã‡§ï‡§∏ ‡§∏‡§§‡•ç‡§∞</li><li class="break-session" style="padding-left: 35px;">‡§õ‡•ã‡§ü‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï</li><li>3. ‡§´‡•ã‡§ï‡§∏ ‡§∏‡§§‡•ç‡§∞</li><li class="break-session" style="padding-left: 35px;">‡§õ‡•ã‡§ü‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï</li><li>4. ‡§´‡•ã‡§ï‡§∏ ‡§∏‡§§‡•ç‡§∞ (1 ‡§ö‡§ï‡•ç‡§∞ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à)</li><li class="break-session" style="padding-left: 35px;">‡§≤‡§Ç‡§¨‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï (‡§â‡§¶‡§æ. 15 ‡§Æ‡§ø‡§®‡§ü)</li></ul><p class="mb-3">‡§´‡•ã‡§ï‡§∏ ‡§∏‡§§‡•ç‡§∞ ‡§î‡§∞ ‡§¨‡•ç‡§∞‡•á‡§ï ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§≤‡§Ç‡§¨‡•á ‡§¨‡•ç‡§∞‡•á‡§ï ‡§ï‡•á ‡§¨‡§æ‡§¶, ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§Ü‡§™‡§ï‡•ã ‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§®‡§Ø‡§æ ‡§ö‡§ï‡•ç‡§∞ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§</p><p class="mb-3">‡§´‡•ã‡§ï‡§∏ ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ï ‡§ï‡•á‡§µ‡§≤ ‡§¶‡§ø‡§® ‡§ï‡§æ ‡§™‡§π‡§≤‡§æ ‡§´‡•ã‡§ï‡§∏ ‡§∏‡§§‡•ç‡§∞ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§¨‡§¢‡§º‡§§‡§æ ‡§π‡•à‡•§</p><p><i class='fas fa-sync-alt fa-xs'></i> ‡§¨‡§ü‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ö‡§ï‡•ç‡§∞ ‡§ï‡•ã ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§</p>`,
                alert_import_title: "‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§Ü‡§Ø‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç?",
                alert_import_body: "‡§Ø‡§π ‡§Ü‡§™‡§ï‡•Ä ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§∏‡§≠‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§‡§ø, ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø‡§Ø‡•ã‡§Ç ‡§î‡§∞ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§ï‡•ã ‡§Ö‡§ß‡§ø‡§≤‡•á‡§ñ‡§ø‡§§ ‡§ï‡§∞ ‡§¶‡•á‡§ó‡§æ‡•§ ‡§Ø‡§π ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§µ‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä‡•§ ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?",
                achievements: {
                    "days1": {"name":"‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§","description":"‡§Ö‡§™‡§®‡§æ ‡§™‡§π‡§≤‡§æ ‡§´‡•ã‡§ï‡§∏ ‡§¶‡§ø‡§µ‡§∏ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "days7": {"name":"‡§∏‡§æ‡§™‡•ç‡§§‡§æ‡§π‡§ø‡§ï ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§¶‡•ç‡§ß‡§§‡§æ","description":"7 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "days15": {"name":"‡§™‡§æ‡§ï‡•ç‡§∑‡§ø‡§ï ‡§´‡•ã‡§ï‡§∏","description":"15 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "days30": {"name":"‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§Æ‡•Ä‡§≤ ‡§ï‡§æ ‡§™‡§§‡•ç‡§•‡§∞","description":"30 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "days50": {"name":"‡§ü‡•Ç‡§ü‡§§‡§æ ‡§§‡§æ‡§∞‡§æ","description":"50 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "days75": {"name":"‡§´‡•ã‡§ï‡§∏ ‡§Æ‡•à‡§∞‡§æ‡§•‡§®‡§∞","description":"75 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "days100": {"name":"‡§Ü‡§¶‡§§ ‡§ï‡§æ ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞","description":"100 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "days120": {"name":"‡§´‡•ã‡§ï‡§∏ ‡§≤‡•á‡§ú‡•á‡§Ç‡§°","description":"120 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "days150": {"name":"‡§´‡•ã‡§ï‡§∏ ‡§ã‡§∑‡§ø","description":"150 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "streak3": {"name":"3-‡§¶‡§ø‡§µ‡§∏‡•Ä‡§Ø ‡§ï‡•â‡§Æ‡•ç‡§¨‡•ã!","description":"3-‡§¶‡§ø‡§µ‡§∏‡•Ä‡§Ø ‡§´‡•ã‡§ï‡§∏ ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ï ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç‡•§"},
                    "streak7": {"name":"‡§è‡§ï ‡§∏‡§™‡•ç‡§§‡§æ‡§π ‡§ï‡•Ä ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ï","description":"7-‡§¶‡§ø‡§µ‡§∏‡•Ä‡§Ø ‡§´‡•ã‡§ï‡§∏ ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ï ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç‡•§"},
                    "streak14": {"name":"‡§Ü‡§¶‡§§ ‡§™‡§æ‡§µ‡§∞-‡§Ö‡§™","description":"14-‡§¶‡§ø‡§µ‡§∏‡•Ä‡§Ø ‡§´‡•ã‡§ï‡§∏ ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ï ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç‡•§"},
                    "streak30": {"name":"‡§¨‡§∏ ‡§Ö‡§ú‡•á‡§Ø","description":"30-‡§¶‡§ø‡§µ‡§∏‡•Ä‡§Ø ‡§´‡•ã‡§ï‡§∏ ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ï ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç‡•§"},
                    "streak50": {"name":"‡§∏‡§ö‡•ç‡§ö‡•Ä ‡§≤‡§ó‡§®","description":"50-‡§¶‡§ø‡§µ‡§∏‡•Ä‡§Ø ‡§´‡•ã‡§ï‡§∏ ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ï ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç‡•§"},
                    "cycles1": {"name":"‡§™‡§π‡§≤‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§ö‡§ï‡•ç‡§∞","description":"1 ‡§™‡•ã‡§Æ‡•ã‡§°‡•ã‡§∞‡•ã ‡§ö‡§ï‡•ç‡§∞ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "cycles10": {"name":"‡§´‡•ã‡§ï‡§∏ ‡§ï‡•á ‡§¶‡§∏ ‡§ö‡§ï‡•ç‡§∞","description":"10 ‡§™‡•ã‡§Æ‡•ã‡§°‡•ã‡§∞‡•ã ‡§ö‡§ï‡•ç‡§∞ ‡§™‡•Ç‡§∞‡•á ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "cycles25": {"name":"‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§ï‡§§‡§æ ‡§™‡•ç‡§∞‡•ã","description":"25 ‡§™‡•ã‡§Æ‡•ã‡§°‡•ã‡§∞‡•ã ‡§ö‡§ï‡•ç‡§∞ ‡§™‡•Ç‡§∞‡•á ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "cycles50": {"name":"‡§ö‡§æ‡§Å‡§¶ ‡§§‡§ï","description":"50 ‡§™‡•ã‡§Æ‡•ã‡§°‡•ã‡§∞‡•ã ‡§ö‡§ï‡•ç‡§∞ ‡§™‡•Ç‡§∞‡•á ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "cycles100": {"name":"‡§∏‡§æ‡§á‡§ï‡§ø‡§≤ ‡§∏‡•á‡§Ç‡§ö‡•Å‡§∞‡§ø‡§Ø‡§®","description":"100 ‡§™‡•ã‡§Æ‡•ã‡§°‡•ã‡§∞‡•ã ‡§ö‡§ï‡•ç‡§∞ ‡§™‡•Ç‡§∞‡•á ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "hours1": {"name":"‡§´‡•ã‡§ï‡§∏ ‡§ï‡§æ ‡§™‡§π‡§≤‡§æ ‡§ò‡§Ç‡§ü‡§æ","description":"1 ‡§ò‡§Ç‡§ü‡•á ‡§ï‡§æ ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§´‡•ã‡§ï‡§∏ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "hours10": {"name":"‡§ó‡§π‡§® ‡§µ‡§ø‡§ö‡§æ‡§∞‡§ï","description":"10 ‡§ò‡§Ç‡§ü‡•á ‡§ï‡§æ ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§´‡•ã‡§ï‡§∏ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "hours50": {"name":"‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡§æ ‡§´‡§µ‡•ç‡§µ‡§æ‡§∞‡§æ","description":"50 ‡§ò‡§Ç‡§ü‡•á ‡§ï‡§æ ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§´‡•ã‡§ï‡§∏ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "hours100": {"name":"‡§∂‡•Å‡§¶‡•ç‡§ß ‡§µ‡§ø‡§¶‡•ç‡§µ‡§æ‡§®","description":"100 ‡§ò‡§Ç‡§ü‡•á ‡§ï‡§æ ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§´‡•ã‡§ï‡§∏ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "sb_hours_1": {"name":"‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§∏‡§æ‡§Ç‡§∏","description":"‡§õ‡•ã‡§ü‡•á ‡§¨‡•ç‡§∞‡•á‡§ï ‡§Æ‡•á‡§Ç 1 ‡§ò‡§Ç‡§ü‡§æ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "sb_hours_5": {"name":"‡§µ‡§ø‡§∂‡•ç‡§∞‡§æ‡§Æ ‡§®‡§ø‡§™‡•Å‡§£","description":"‡§õ‡•ã‡§ü‡•á ‡§¨‡•ç‡§∞‡•á‡§ï ‡§Æ‡•á‡§Ç 5 ‡§ò‡§Ç‡§ü‡•á ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "sb_hours_15": {"name":"‡§∂‡•â‡§∞‡•ç‡§ü ‡§¨‡•ç‡§∞‡•á‡§ï ‡§ö‡•à‡§Ç‡§™‡§ø‡§Ø‡§®","description":"‡§õ‡•ã‡§ü‡•á ‡§¨‡•ç‡§∞‡•á‡§ï ‡§Æ‡•á‡§Ç 15 ‡§ò‡§Ç‡§ü‡•á ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "lb_hours_3": {"name":"‡§∏‡•Å‡§™‡§æ‡§§‡•ç‡§∞ ‡§Ü‡§∞‡§æ‡§Æ","description":"‡§≤‡§Ç‡§¨‡•á ‡§¨‡•ç‡§∞‡•á‡§ï ‡§Æ‡•á‡§Ç 3 ‡§ò‡§Ç‡§ü‡•á ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "lb_hours_10": {"name":"‡§∞‡§ø‡§ö‡§æ‡§∞‡•ç‡§ú ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞","description":"‡§≤‡§Ç‡§¨‡•á ‡§¨‡•ç‡§∞‡•á‡§ï ‡§Æ‡•á‡§Ç 10 ‡§ò‡§Ç‡§ü‡•á ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"},
                    "lb_hours_25": {"name":"‡§Ö‡§µ‡§ï‡§æ‡§∂ ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û","description":"‡§≤‡§Ç‡§¨‡•á ‡§¨‡•ç‡§∞‡•á‡§ï ‡§Æ‡•á‡§Ç 25 ‡§ò‡§Ç‡§ü‡•á ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"}
                }
            }
        };
       
        const timerTextEl = document.getElementById('timerText');
        const modePillEl = document.getElementById('modePill');
        const cycleDotsContainerEl = document.getElementById('cycleDotsContainer');
        const resetButton = document.getElementById('resetButton');
        const resetCycleCountButtonEl = document.getElementById('resetCycleCountButton');
        const startPauseButton = document.getElementById('startPauseButton');
        const skipBreakButton = document.getElementById('skipBreakButton'); 
        const settingsButton = document.getElementById('settingsButton');
        const helpButton = document.getElementById('helpButton'); 
        const settingsModal = document.getElementById('settingsModal');
        const saveSettingsButton = document.getElementById('saveSettingsButton');
        const cancelSettingsButton = document.getElementById('cancelSettingsButton');
        const studyTimeInput = document.getElementById('studyTimeInput');
        const shortBreakTimeInput = document.getElementById('shortBreakTimeInput');
        const longBreakTimeInput = document.getElementById('longBreakTimeInput');
        const languageSelect = document.getElementById('languageSelect');
        const soundToggle = document.getElementById('soundToggle');
        const exportDataButton = document.getElementById('exportDataButton');
        const importDataButton = document.getElementById('importDataButton');
        const importFileInput = document.getElementById('importFileInput');
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabPanes = document.querySelectorAll('.tab-pane');
        const dailyCyclesEl = document.getElementById('dailyCycles'); 
        const dailyStudyTimeEl = document.getElementById('dailyStudyTime');
        const dailyTotalTimeEl = document.getElementById('dailyTotalTime');
        const totalDaysStudiedEl = document.getElementById('totalDaysStudied');
        const totalCyclesEl = document.getElementById('totalCycles');
        const totalStudyTimeEl = document.getElementById('totalStudyTime');
        const streakCounterHeaderEl = document.getElementById('streakCounterHeader'); 
        const streakFireIconContainerEl = document.getElementById('streakFireIconContainer');
        const rewardNameInput = document.getElementById('rewardName');
        const rewardTypeSelect = document.getElementById('rewardType');
        const rewardThresholdInput = document.getElementById('rewardThreshold');
        const addRewardButton = document.getElementById('addRewardButton');
        const rewardsListEl = document.getElementById('rewardsList');
        const achievementsListEl = document.getElementById('achievementsList');
        const customAlertModal = document.getElementById('customAlertModal');
        const customAlertIconEl = document.getElementById('customAlertIcon');
        const customAlertTitleEl = document.getElementById('customAlertTitle');
        const customAlertMessageEl = document.getElementById('customAlertMessage');
        const customAlertConfirmButton = document.getElementById('customAlertConfirmButton');
        const customAlertCancelButton = document.getElementById('customAlertCancelButton');
        const customAlertButtonsContainer = document.getElementById('customAlertButtons');
        const faviconEl = document.getElementById('favicon'); 
        const toastNotificationEl = document.getElementById('toastNotification');
        const toastTitleEl = document.getElementById('toastTitle');
        const toastBodyEl = document.getElementById('toastBody');
        const rewardsTabBadgeEl = document.getElementById('rewardsTabBadge');
        const achievementsTabBadgeEl = document.getElementById('achievementsTabBadge');
        const languageModal = document.getElementById('languageModal');
        const languageButtonsContainer = document.getElementById('languageButtonsContainer');
        const appContainer = document.getElementById('app-container');

        let timeLeft;
        let currentMode = 'study';
        let isRunning = false;
        let pomodorosInCycle = 0;
        const POMODOROS_PER_CYCLE = 4;
        let lastSoundScheduledTime = 0;
        const MIN_SOUND_INTERVAL = 0.05, SOUND_BASE_DELAY = 0.05;
        let justSeenRewardIds = [], justSeenAchievementIds = [];
        let appData = {
            settings: { studyTime: 25, shortBreakTime: 5, longBreakTime: 15, soundEnabled: true, language: 'en' },
            timerState: { lastTimerUsed: null, persistedCurrentMode: "study", persistedTimeLeft: null, persistedIsRunning: false, persistedPomodorosInCycle: 0, persistedPreviousPomodorosInCycle: null },
            stats: {
                daily: { date: getTodayDateString(), cyclesCompleted: 0, pureStudySeconds: 0, totalTimeTodaySeconds: 0, firstStudySessionCompletedToday: false },
                general: { totalDaysStudied: 0, totalCyclesCompleted: 0, totalPureStudySeconds: 0, streak: 0, lastStudyDate: null, totalShortBreakSeconds: 0, totalLongBreakSeconds: 0 }
            },
            rewards: [],
            achievements: [],
            uiState: { newRewardsCount: 0, newAchievementsCount: 0 },
            appVersion: "1.9.3"
        };
       
        let synth;
        if (typeof Tone !== 'undefined') {
            synth = new Tone.Synth().toDestination();
        } else {
            console.warn("Tone.js not loaded. Sound effects will be disabled.");
        }

        function playSound(note = 'C4', duration = '8n', type = 'timerComplete') {
            if (!appData.settings.soundEnabled || !synth) return;
            if (Tone.context.state !== 'running') {
                Tone.context.resume().catch(e => console.error("Error resuming AudioContext:", e));
            }
            if (Tone.Transport.state !== "started") {
                Tone.Transport.start();
            }
            try {
                let soundNote = note, soundDuration = duration, soundVolume = 0;
                if (type === 'achievement') { soundNote = "C5"; soundDuration = "4n"; soundVolume = -6; } 
                else if (type === 'reward') { soundNote = "E5"; soundDuration = "4n"; soundVolume = -6; }
                const currentTime = Tone.now();
                const scheduledTime = Math.max(currentTime + SOUND_BASE_DELAY, lastSoundScheduledTime + MIN_SOUND_INTERVAL);
                lastSoundScheduledTime = scheduledTime;
                synth.volume.setValueAtTime(soundVolume, scheduledTime);
                synth.triggerAttackRelease(soundNote, soundDuration, scheduledTime);
            } catch (error) {
                console.error(`Error playing sound (type: ${type}):`, error);
            }
        }
       
        function getTodayDateString() {
            const today = new Date();
            return `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
        }
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }
        function formatHoursMinutes(totalSeconds) {
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            return `${hours}h ${minutes}m`;
        }
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }
       
        function getText(key, ...args) {
            const lang = appData.settings.language || 'en';
            let text = translations[lang]?.[key] || translations['en'][key];
            if (!text) return key;

            if (args.length > 0) {
                args.forEach((arg, index) => {
                    text = text.replace(`{${index}}`, arg);
                });
            }
            return text;
        }

        function applyTranslations() {
            const lang = appData.settings.language || 'en';
            document.documentElement.lang = lang; 
            document.title = getText('app_title');

            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.dataset.translateKey;
                const translation = getText(key);

                if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                    if (el.placeholder) el.placeholder = translation;
                } else if (el.title) {
                    el.title = translation;
                } else {
                    const targetEl = el.querySelector('span') || el;
                    if(targetEl && targetEl.innerHTML !== translation) {
                        targetEl.innerHTML = translation;
                    }
                }
            });
            const donationEl = document.querySelector('[data-translate-key="donation_text"]');
            if(donationEl) {
                 const linkHtml = `<a href="https://www.buymeacoffee.com/lemonade299792458" target="_blank" class="donation-section-link">${getText('donation_link_text')}</a>`;
                 donationEl.innerHTML = getText('donation_text', linkHtml);
            }
        }

        const STORAGE_KEY = 'pomodoroGamifiedAppData';
        function saveTimerState() {
            appData.timerState.persistedCurrentMode = currentMode;
            appData.timerState.persistedTimeLeft = timeLeft;
            appData.timerState.persistedIsRunning = isRunning;
            appData.timerState.persistedPomodorosInCycle = pomodorosInCycle;
            saveData();
        }

        function buildAchievements(lang, savedAchievements = []) {
             const achievementTexts = translations[lang]?.achievements || translations['en'].achievements;
             return baseAchievements.map(baseAch => {
                const userAchData = savedAchievements.find(ua => ua.id === baseAch.id) || {};
                const translatedText = achievementTexts[baseAch.id];
                return {
                    ...baseAch,
                    name: translatedText.name,
                    description: translatedText.description,
                    unlocked: userAchData.unlocked || false,
                    unlockedDate: userAchData.unlockedDate || null,
                    seen: userAchData.seen || (userAchData.unlocked || false)
                };
            });
        }
        
        function isObject(item) {
            return (item && typeof item === 'object' && !Array.isArray(item));
        }

        function mergeDeep(target, ...sources) {
            if (!sources.length) return target;
            const source = sources.shift();

            if (isObject(target) && isObject(source)) {
                for (const key in source) {
                    if (isObject(source[key])) {
                        if (!target[key]) Object.assign(target, { [key]: {} });
                        mergeDeep(target[key], source[key]);
                    } else {
                        Object.assign(target, { [key]: source[key] });
                    }
                }
            }
            return mergeDeep(target, ...sources);
        }

        function loadData() {
            const storedData = localStorage.getItem(STORAGE_KEY);
            const defaultAppData = JSON.parse(JSON.stringify(appData));
            
            if (storedData) {
                try {
                    const parsedData = JSON.parse(storedData);
                    
                    // Use deep merge to safely update appData with stored data,
                    // preserving new properties from the default structure if the app was updated.
                    appData = mergeDeep(defaultAppData, parsedData);

                    // Re-build achievements with potentially new language after loading settings
                    const lang = appData.settings.language || 'en';
                    appData.achievements = buildAchievements(lang, parsedData.achievements);

                } catch (e) {
                    console.error("Failed to parse stored data, using defaults.", e);
                    appData.achievements = buildAchievements(appData.settings.language);
                }
            } else {
                 appData.achievements = buildAchievements(appData.settings.language);
            }

            if (appData.stats.daily.date !== getTodayDateString()) {
                resetDailyStats();
                appData.uiState.newRewardsCount = 0;
                appData.rewards.forEach(r => r.seen = false);
            }

            studyTimeInput.value = appData.settings.studyTime;
            shortBreakTimeInput.value = appData.settings.shortBreakTime;
            longBreakTimeInput.value = appData.settings.longBreakTime;
            soundToggle.checked = appData.settings.soundEnabled;
            languageSelect.value = appData.settings.language;

            updateRewardTabNotificationBadge();
            updateAchievementTabNotificationBadge();
        }
        function saveData() {
            appData.pomodorosInCycle = pomodorosInCycle;
            const achievementsToSave = appData.achievements.map(ach => ({
                id: ach.id,
                unlocked: ach.unlocked,
                unlockedDate: ach.unlockedDate,
                seen: ach.seen
            }));
            const dataToSave = { ...appData, achievements: achievementsToSave };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
        }

        let toastTimeout;
        function showToast(title, body, type = 'info', duration = 4000) {
            clearTimeout(toastTimeout);
            toastTitleEl.textContent = title;
            toastBodyEl.textContent = body;
            toastNotificationEl.className = 'fixed top-5 right-5 p-4 rounded-md text-white z-[1000] transition-all duration-500 max-w-xs shadow-lg';
            switch (type) {
                case 'success': toastNotificationEl.classList.add('bg-green-500', 'show'); break;
                case 'error': toastNotificationEl.classList.add('bg-red-500', 'show'); break;
                case 'warning': toastNotificationEl.classList.add('bg-yellow-500', 'show'); break;
                default: toastNotificationEl.classList.add('bg-sky-500', 'show');
            }
            toastTimeout = setTimeout(() => { toastNotificationEl.classList.remove('show'); }, duration);
        }
        function updateRewardTabNotificationBadge() {
            const unseenRewards = appData.rewards.filter(r => r.earnedToday && !r.seen).length;
            appData.uiState.newRewardsCount = unseenRewards;
            rewardsTabBadgeEl.style.display = unseenRewards > 0 ? 'inline-block' : 'none';
            if (unseenRewards > 0) rewardsTabBadgeEl.textContent = unseenRewards;
        }
        function updateAchievementTabNotificationBadge() {
            const unseenAchievements = appData.achievements.filter(ach => ach.unlocked && !ach.seen).length;
            appData.uiState.newAchievementsCount = unseenAchievements;
            achievementsTabBadgeEl.style.display = unseenAchievements > 0 ? 'inline-block' : 'none';
            if (unseenAchievements > 0) achievementsTabBadgeEl.textContent = unseenAchievements;
        }
        let currentConfirmCallback = null, currentCancelCallback = null;
        function showCustomAlert(title, message, iconClass = "fas fa-info-circle text-sky-400", confirmText = "OK", cancelText = null, confirmCallback = null, cancelCallback = null) {
            customAlertTitleEl.textContent = title;
            customAlertMessageEl.innerHTML = message;
            customAlertIconEl.className = `text-3xl mr-4 mt-1 ${iconClass}`;
            customAlertConfirmButton.textContent = confirmText;
            currentConfirmCallback = confirmCallback;
            if (cancelText && typeof cancelCallback === 'function') {
                customAlertCancelButton.textContent = cancelText;
                customAlertCancelButton.classList.remove('hidden');
                customAlertButtonsContainer.classList.remove('justify-end');
                customAlertButtonsContainer.classList.add('justify-center');
                currentCancelCallback = cancelCallback;
            } else {
                customAlertCancelButton.classList.add('hidden');
                customAlertButtonsContainer.classList.remove('justify-center');
                customAlertButtonsContainer.classList.add('justify-end');
                currentCancelCallback = null;
            }
            customAlertModal.classList.add('show');
        }
        customAlertConfirmButton.addEventListener('click', () => {
            if (typeof currentConfirmCallback === 'function') currentConfirmCallback();
            customAlertModal.classList.remove('show');
            currentConfirmCallback = null; currentCancelCallback = null;
        });
        customAlertCancelButton.addEventListener('click', () => {
            if (typeof currentCancelCallback === 'function') currentCancelCallback();
            customAlertModal.classList.remove('show');
            currentConfirmCallback = null; currentCancelCallback = null;
        });

        function updateTimerDisplay() {
            timerTextEl.textContent = formatTime(timeLeft);
            let modeKey = '', bodyClass = 'bg-slate-900', timerColorClass = 'text-sky-400', pillClass = 'bg-sky-400/10 text-sky-400';
           
            switch (currentMode) {
                case 'study':
                    modeKey = 'mode_study';
                    bodyClass = 'bg-slate-900';
                    timerColorClass = 'text-sky-400';
                    pillClass = 'bg-sky-400/10 text-sky-400';
                    skipBreakButton.classList.add('hidden'); 
                    break;
                case 'shortBreak':
                    modeKey = 'mode_short_break';
                    bodyClass = 'bg-green-900';
                    timerColorClass = 'text-green-400';
                    pillClass = 'bg-green-400/10 text-green-400';
                    skipBreakButton.classList.remove('hidden'); 
                    break;
                case 'longBreak':
                    modeKey = 'mode_long_break';
                    bodyClass = 'bg-purple-900';
                    timerColorClass = 'text-purple-400';
                    pillClass = 'bg-purple-400/10 text-purple-400';
                    skipBreakButton.classList.remove('hidden'); 
                    break;
            }
            modePillEl.textContent = getText(modeKey);
            modePillEl.className = `py-1 px-3 rounded-full text-sm font-semibold transition-all duration-500 ${pillClass}`;
            timerTextEl.className = `timer-text transition-colors duration-500 ${timerColorClass}`;
            document.body.className = document.body.className.replace(/bg-(slate|green|purple)-900/g, '') + ` ${bodyClass}`;
            document.title = `${formatTime(timeLeft)} - ${getText(modeKey)}`; 
            updateCycleInfo();
        }

        function updateCycleInfo() {
            const dots = cycleDotsContainerEl.children;
            for (let i = 0; i < dots.length; i++) {
                const dot = dots[i];
                dot.className = 'cycle-dot';
                let borderColorClass = 'border-sky-400';
                 if(currentMode === 'shortBreak') borderColorClass = 'border-green-400';
                 else if(currentMode === 'longBreak') borderColorClass = 'border-purple-400';

                if (i < pomodorosInCycle) {
                    dot.classList.add('bg-sky-500');
                } else if (i === pomodorosInCycle && currentMode === 'study') {
                    dot.classList.add('bg-transparent', 'border-2', borderColorClass);
                } else {
                    dot.classList.add('bg-slate-600');
                }
            }
        }
       
        function updateStatsDisplay() {
            dailyCyclesEl.textContent = appData.stats.daily.cyclesCompleted;
            dailyStudyTimeEl.textContent = formatHoursMinutes(appData.stats.daily.pureStudySeconds);
            if (dailyTotalTimeEl) dailyTotalTimeEl.textContent = formatHoursMinutes(appData.stats.daily.totalTimeTodaySeconds);
            totalDaysStudiedEl.textContent = appData.stats.general.totalDaysStudied;
            totalCyclesEl.textContent = appData.stats.general.totalCyclesCompleted;
            totalStudyTimeEl.textContent = formatHoursMinutes(appData.stats.general.totalPureStudySeconds);
            if (streakCounterHeaderEl) streakCounterHeaderEl.textContent = appData.stats.general.streak;
            if (streakFireIconContainerEl) {
                const streak = appData.stats.general.streak;
                let fireColorClass = 'text-slate-400';
                if (streak >= 50) fireColorClass = 'text-yellow-400';
                else if (streak >= 40) fireColorClass = 'text-teal-400';
                else if (streak >= 35) fireColorClass = 'text-sky-400';
                else if (streak >= 30) fireColorClass = 'text-blue-500';
                else if (streak >= 25) fireColorClass = 'text-indigo-500';
                else if (streak >= 20) fireColorClass = 'text-purple-500';
                else if (streak >= 15) fireColorClass = 'text-red-600';
                else if (streak >= 10) fireColorClass = 'text-red-500';
                else if (streak >= 5) fireColorClass = 'text-red-400';
                else if (streak >= 1) fireColorClass = 'text-orange-400';
                streakFireIconContainerEl.className = '';
                streakFireIconContainerEl.classList.add(fireColorClass);
                streakFireIconContainerEl.innerHTML = '<i class="fas fa-fire"></i>';
            }
        }
        function renderRewards() {
            rewardsListEl.innerHTML = "";
            if (appData.rewards.length === 0) {
                rewardsListEl.innerHTML = `<p class="text-slate-400 italic">${getText('rewards_no_rewards')}</p>`;
                return;
            }
            appData.rewards.forEach(reward => {
                const isNew = justSeenRewardIds.includes(reward.id);
                const newIndicatorHTML = isNew ? `<span class="ml-2 text-xs font-bold text-yellow-300 animate-pulse new-indicator">${getText('new_badge')}</span>` : '';
                const rewardEl = document.createElement('div');
                rewardEl.className = `p-2 rounded-lg flex justify-between items-center transition-all ${reward.earnedToday ? 'bg-green-600 shadow-lg' : 'bg-slate-500'} ${isNew ? 'ring-1 ring-yellow-400 ring-inset' : ''}`;
               
                let progressText = '';
                let progressPercent = 0;
                const rewardTypeDisplay = reward.type === 'cycles' ? getText('rewards_type_cycles') : getText('rewards_type_hours');
                const rewardUnitDisplay = reward.type === 'cycles' ? 'cycles' : 'hours';
               
                if (reward.type === 'cycles') {
                    progressText = `${appData.stats.daily.cyclesCompleted}/${reward.threshold} ${rewardUnitDisplay}`;
                    progressPercent = Math.min(100, (appData.stats.daily.cyclesCompleted / reward.threshold) * 100);
                } else {
                    const currentHours = appData.stats.daily.pureStudySeconds / 3600;
                    progressText = `${currentHours.toFixed(1)}/${reward.threshold} ${rewardUnitDisplay}`;
                    progressPercent = Math.min(100, (currentHours / reward.threshold) * 100);
                }
                const goalText = getText('rewards_goal_label');
                const progressLabel = getText('rewards_progress_label');

                rewardEl.innerHTML = `<div class="flex-grow overflow-hidden"><div class="flex items-baseline"><p class="font-semibold ${reward.earnedToday ? 'text-white' : 'text-sky-300'} truncate mr-1">${reward.name}</p>${newIndicatorHTML}</div><p class="text-xs ${reward.earnedToday ? 'text-green-200' : 'text-slate-300'}">${goalText}: ${reward.threshold} ${rewardUnitDisplay} | ${progressLabel}: ${progressText}</p><div class="mt-1 h-4 flex items-center">${!reward.earnedToday ? `<div class="progress-bar-container w-full"><div class="progress-bar" style="width: ${progressPercent}%;"></div></div>` : `<p class="text-xs text-green-100 font-bold"><i class="fas fa-check-circle mr-1"></i>${getText('rewards_earned_today')}</p>`}</div></div><button data-id="${reward.id}" class="delete-reward-button text-red-300 hover:text-red-500 p-2 rounded-full transition-colors flex-shrink-0 ml-2"><i class="fas fa-trash-alt"></i></button>`;
                rewardsListEl.appendChild(rewardEl);
            });
            document.querySelectorAll('.delete-reward-button').forEach(button => {
                button.addEventListener('click', (e) => {
                    const rewardId = e.currentTarget.dataset.id;
                    appData.rewards = appData.rewards.filter(r => r.id !== rewardId);
                    saveData();
                    renderRewards();
                    updateRewardTabNotificationBadge();
                });
            });
        }
        function renderAchievements() {
            achievementsListEl.innerHTML = "";
            appData.achievements.sort((a, b) => {
                const aIsNewlyUnlocked = justSeenAchievementIds.includes(a.id), bIsNewlyUnlocked = justSeenAchievementIds.includes(b.id);
                if (aIsNewlyUnlocked && !bIsNewlyUnlocked) return -1;
                if (!aIsNewlyUnlocked && bIsNewlyUnlocked) return 1;
                const aIsUnlocked = a.unlocked, bIsUnlocked = b.unlocked;
                if (!aIsUnlocked && !bIsUnlocked) {
                    let currentValueA = 0;
                    switch (a.type) {
                        case 'totalDaysStudied': currentValueA = appData.stats.general.totalDaysStudied; break;
                        case 'totalCyclesCompleted': currentValueA = appData.stats.general.totalCyclesCompleted; break;
                        case 'totalPureStudyHours': currentValueA = appData.stats.general.totalPureStudySeconds / 3600; break;
                        case 'streak': currentValueA = appData.stats.general.streak; break;
                        case 'totalShortBreakSeconds': currentValueA = appData.stats.general.totalShortBreakSeconds; break;
                        case 'totalLongBreakSeconds': currentValueA = appData.stats.general.totalLongBreakSeconds; break;
                    }
                    const progressA = a.threshold > 0 ? (currentValueA / a.threshold) : -1;
                    let currentValueB = 0;
                    switch (b.type) {
                        case 'totalDaysStudied': currentValueB = appData.stats.general.totalDaysStudied; break;
                        case 'totalCyclesCompleted': currentValueB = appData.stats.general.totalCyclesCompleted; break;
                        case 'totalPureStudyHours': currentValueB = appData.stats.general.totalPureStudySeconds / 3600; break;
                        case 'streak': currentValueB = appData.stats.general.streak; break;
                        case 'totalShortBreakSeconds': currentValueB = appData.stats.general.totalShortBreakSeconds; break;
                        case 'totalLongBreakSeconds': currentValueB = appData.stats.general.totalLongBreakSeconds; break;
                    }
                    const progressB = b.threshold > 0 ? (currentValueB / b.threshold) : -1;
                    if (progressA > progressB) return -1;
                    if (progressA < progressB) return 1;
                    if (a.threshold < b.threshold) return -1;
                    if (a.threshold > b.threshold) return 1;
                    return 0;
                }
                if (!aIsUnlocked && bIsUnlocked && !bIsNewlyUnlocked) return -1;
                if (aIsUnlocked && !aIsNewlyUnlocked && !bIsUnlocked) return 1;
                if (aIsUnlocked && !aIsNewlyUnlocked && bIsUnlocked && !bIsNewlyUnlocked) {
                    return new Date(b.unlockedDate) - new Date(a.unlockedDate);
                }
                return 0;
            });
            appData.achievements.forEach(ach => {
                const isNew = justSeenAchievementIds.includes(ach.id);
                const newIndicatorHTML = isNew ? `<span class="ml-1 text-xs font-bold text-yellow-300 animate-pulse new-indicator">${getText('new_badge')}</span>` : '';
                const achEl = document.createElement('div');
                achEl.className = `achievement-item p-3 rounded-lg shadow-md transition-all ${ach.unlocked ? 'unlocked bg-sky-600' : 'locked bg-slate-600'} ${isNew ? 'ring-1 ring-yellow-400 ring-inset' : ''}`;
               
                let mainContentHTML = `<div class="flex items-start mb-1"><i class="${ach.icon || 'fas fa-question-circle'} text-xl ${ach.unlocked ? 'text-yellow-300' : 'text-slate-400'} mr-2 mt-1"></i><div class="flex-grow overflow-hidden"><div class="flex items-baseline"><h4 class="font-semibold text-sm ${ach.unlocked ? 'text-white' : 'text-sky-300'} truncate mr-1">${ach.name}</h4>${newIndicatorHTML}</div><p class="text-xs ${ach.unlocked ? 'text-sky-100' : 'text-slate-300'} leading-tight">${ach.description}</p></div></div>`;
                let progressSectionHTML = '<div class="mt-auto">';
                if (ach.unlocked) {
                    const unlockedDate = new Date(ach.unlockedDate).toLocaleDateString(appData.settings.language.replace('_', '-'));
                    progressSectionHTML += `<div class="progress-bar-container"><div class="progress-bar bg-green-500" style="width: 100%;"></div></div><p class="text-xs text-yellow-200 font-semibold mt-1"><i class="fas fa-check-circle mr-1"></i>${getText('unlocked_on_date', unlockedDate)}</p>`;
                } else {
                    let currentValue = 0;
                    switch (ach.type) {
                        case 'totalDaysStudied': currentValue = appData.stats.general.totalDaysStudied; break;
                        case 'totalCyclesCompleted': currentValue = appData.stats.general.totalCyclesCompleted; break;
                        case 'totalPureStudyHours': currentValue = appData.stats.general.totalPureStudySeconds / 3600; break;
                        case 'streak': currentValue = appData.stats.general.streak; break;
                        case 'totalShortBreakSeconds': currentValue = appData.stats.general.totalShortBreakSeconds; break;
                        case 'totalLongBreakSeconds': currentValue = appData.stats.general.totalLongBreakSeconds; break;
                    }
                    let displayThreshold = ach.threshold, displayCurrentValue = currentValue;
                    if (ach.type === 'totalShortBreakSeconds' || ach.type === 'totalLongBreakSeconds') {
                        if (ach.threshold >= 3600) { displayCurrentValue = (currentValue / 3600).toFixed(1); displayThreshold = (ach.threshold / 3600).toFixed(1) + "h"; }
                        else { displayCurrentValue = (currentValue / 60).toFixed(0); displayThreshold = (ach.threshold / 60).toFixed(0) + "m"; }
                    } else if (ach.type === 'totalPureStudyHours') {
                        displayCurrentValue = currentValue.toFixed(1); displayThreshold = ach.threshold + "h";
                    } else {
                        displayCurrentValue = currentValue.toFixed(0); displayThreshold = ach.threshold;
                    }
                    const progressPercent = ach.threshold > 0 ? Math.min(100, (currentValue / ach.threshold) * 100) : 0;
                    progressSectionHTML += `<div class="progress-bar-container"><div class="progress-bar bg-sky-400" style="width: ${progressPercent.toFixed(2)}%;"></div></div><p class="text-xs text-slate-400 mt-1">${getText('progress_label', displayCurrentValue, displayThreshold)}</p>`;
                }
                progressSectionHTML += '</div>';
                achEl.innerHTML = mainContentHTML + progressSectionHTML;
                achievementsListEl.appendChild(achEl);
            });
        }
       
        function setTimer(mode) {
            appData.timerState.forcedBreakContextSession = null;
            currentMode = mode;
            isRunning = false;
            startPauseButton.querySelector('span').textContent = getText('start_button');
            startPauseButton.querySelector('i').className = 'fas fa-play mr-2';

            if (timerWorker) timerWorker.postMessage({ command: 'pause' });
            switch (mode) {
                case 'study': timeLeft = appData.settings.studyTime * 60; break;
                case 'shortBreak': timeLeft = appData.settings.shortBreakTime * 60; break;
                case 'longBreak': timeLeft = appData.settings.longBreakTime * 60; break;
                default: console.error("Unknown mode in setTimer:", mode); timeLeft = appData.settings.studyTime * 60; currentMode = 'study';
            }
            if (timerWorker) timerWorker.postMessage({ command: 'setMode', mode: currentMode, duration: timeLeft });
            updateTimerDisplay();
            saveTimerState();
        }
        function startTimer() {
            if (timeLeft <= 0) {
                setTimer(currentMode);
                if (timeLeft <= 0) {
                    console.error(`startTimer: Cannot start timer for ${currentMode}, timeLeft is still ${timeLeft} after reset. Check settings.`);
                    startPauseButton.querySelector('span').textContent = getText('start_button');
                    startPauseButton.querySelector('i').className = 'fas fa-play mr-2';
                    isRunning = false;
                    return;
                }
            }
            isRunning = true;
            startPauseButton.querySelector('span').textContent = getText('pause_button');
            startPauseButton.querySelector('i').className = 'fas fa-pause mr-2';
            if (timerWorker) timerWorker.postMessage({ command: 'start' });
            saveTimerState();
        }
        function pauseTimer() {
            isRunning = false;
            startPauseButton.querySelector('span').textContent = getText('resume_button');
            startPauseButton.querySelector('i').className = 'fas fa-play mr-2';
            if (timerWorker) timerWorker.postMessage({ command: 'pause' });
            saveTimerState();
        }
        function handleTimerEnd() {
            isRunning = false;
            const endedMode = currentMode;
            appData.timerState.lastTimerUsed = endedMode;
            let notificationTitleKey = "", notificationBodyKey = "", soundNoteForEndedMode = 'C4';
            let nextModeToTransitionTo = null, showCycleCompleteNotification = false, completedTime = 0, shouldAutoStart = true;
            if (endedMode === 'study') {
                completedTime = appData.settings.studyTime * 60;
                appData.stats.daily.pureStudySeconds += completedTime;
                appData.stats.general.totalPureStudySeconds += completedTime;
                pomodorosInCycle++;
                notificationTitleKey = "toast_study_complete_title";
                notificationBodyKey = "toast_study_complete_body";
                soundNoteForEndedMode = 'C5';
                if (!appData.stats.daily.firstStudySessionCompletedToday) {
                    appData.stats.daily.firstStudySessionCompletedToday = true;
                    const todayStr = getTodayDateString();
                    if (appData.stats.general.lastStudyDate !== todayStr) {
                        appData.stats.general.totalDaysStudied++;
                        const yesterday = new Date();
                        yesterday.setDate(yesterday.getDate() - 1);
                        const yesterdayStr = `${yesterday.getFullYear()}-${String(yesterday.getMonth() + 1).padStart(2, '0')}-${String(yesterday.getDate()).padStart(2, '0')}`;
                        appData.stats.general.streak = appData.stats.general.lastStudyDate === yesterdayStr ? appData.stats.general.streak + 1 : 1;
                        appData.stats.general.lastStudyDate = todayStr;
                    }
                }
                if (pomodorosInCycle >= POMODOROS_PER_CYCLE) {
                    nextModeToTransitionTo = 'longBreak';
                    appData.stats.daily.cyclesCompleted++;
                    appData.stats.general.totalCyclesCompleted++;
                    showCycleCompleteNotification = true;
                } else {
                    nextModeToTransitionTo = 'shortBreak';
                }
            } else if (endedMode === 'shortBreak') {
                completedTime = appData.settings.shortBreakTime * 60;
                appData.stats.general.totalShortBreakSeconds += completedTime;
                notificationTitleKey = "toast_break_over_title";
                notificationBodyKey = "toast_break_over_body";
                soundNoteForEndedMode = 'E4';
                nextModeToTransitionTo = 'study';
            } else if (endedMode === 'longBreak') {
                completedTime = appData.settings.longBreakTime * 60;
                appData.stats.general.totalLongBreakSeconds += completedTime;
                notificationTitleKey = "toast_long_break_over_title";
                notificationBodyKey = "toast_long_break_over_body";
                soundNoteForEndedMode = 'E4';
                pomodorosInCycle = 0;
                nextModeToTransitionTo = 'study';
                shouldAutoStart = false;
            }
            if (completedTime > 0) {
                appData.stats.daily.totalTimeTodaySeconds += completedTime;
            }
            updateStatsDisplay();
            checkRewards();
            checkAchievements();
            saveData();
            playSound(soundNoteForEndedMode, '4n', 'timerComplete');
            showToast(getText(notificationTitleKey), getText(notificationBodyKey), 'info');
            if (showCycleCompleteNotification) {
                showToast(getText("toast_cycle_complete_title"), getText("toast_cycle_complete_body"), 'success', 5000);
            }
            if (nextModeToTransitionTo) {
                setTimer(nextModeToTransitionTo);
                if (shouldAutoStart) startTimer();
            } else {
                startPauseButton.querySelector('span').textContent = getText('start_button');
                startPauseButton.querySelector('i').className = 'fas fa-play mr-2';
            }
        }
        function resetCurrentTimer() {
            if (isRunning && timerWorker) timerWorker.postMessage({ command: 'pause' });
            isRunning = false;
            let newTimeLeft;
            switch(currentMode) {
                case 'study': newTimeLeft = appData.settings.studyTime * 60; break;
                case 'shortBreak': newTimeLeft = appData.settings.shortBreakTime * 60; break;
                case 'longBreak': newTimeLeft = appData.settings.longBreakTime * 60; break;
                default: newTimeLeft = appData.settings.studyTime * 60;
            }
            timeLeft = newTimeLeft;
            if (timerWorker) timerWorker.postMessage({ command: 'setMode', mode: currentMode, duration: timeLeft });
            startPauseButton.querySelector('span').textContent = getText('start_button');
            startPauseButton.querySelector('i').className = 'fas fa-play mr-2';
            updateTimerDisplay();
            saveTimerState();
        }

        function resetDailyStats() {
            appData.stats.daily = { date: getTodayDateString(), cyclesCompleted: 0, pureStudySeconds: 0, totalTimeTodaySeconds: 0, firstStudySessionCompletedToday: false };
            appData.rewards.forEach(reward => { reward.earnedToday = false; reward.notificationShown = false; reward.seen = false; });
            appData.uiState.newRewardsCount = 0;
            updateRewardTabNotificationBadge();
        }
       
        function checkRewards() {
            let newRewardEarnedThisCheck = false;
            appData.rewards.forEach(reward => {
                if (reward.earnedToday && reward.notificationShown && reward.seen) return;
                let currentProgress = reward.type === 'cycles' ? appData.stats.daily.cyclesCompleted : appData.stats.daily.pureStudySeconds / 3600;
                if (currentProgress >= reward.threshold && !reward.earnedToday) {
                    reward.earnedToday = true;
                    reward.seen = false;
                    newRewardEarnedThisCheck = true;
                    if (!reward.notificationShown) {
                        showToast(getText("toast_reward_earned_title"), getText("toast_reward_earned_body", reward.name), 'success');
                        playSound('G5', '2n', 'reward');
                        reward.notificationShown = true;
                    }
                }
            });
            if (newRewardEarnedThisCheck) {
                renderRewards();
                updateRewardTabNotificationBadge();
                saveData();
            }
        }
        function checkAchievements() {
            let newAchievementUnlockedThisCheck = false;
            appData.achievements.forEach(ach => {
                if (ach.unlocked) return;
                let currentValue;
                switch (ach.type) {
                    case 'totalDaysStudied': currentValue = appData.stats.general.totalDaysStudied; break;
                    case 'totalCyclesCompleted': currentValue = appData.stats.general.totalCyclesCompleted; break;
                    case 'totalPureStudyHours': currentValue = appData.stats.general.totalPureStudySeconds / 3600; break;
                    case 'streak': currentValue = appData.stats.general.streak; break;
                    case 'totalShortBreakSeconds': currentValue = appData.stats.general.totalShortBreakSeconds; break;
                    case 'totalLongBreakSeconds': currentValue = appData.stats.general.totalLongBreakSeconds; break;
                    default: return;
                }
                if (currentValue >= ach.threshold && !ach.unlocked) {
                    ach.unlocked = true;
                    ach.unlockedDate = new Date().toISOString();
                    ach.seen = false;
                    newAchievementUnlockedThisCheck = true;
                    if (!ach.notificationShown) {
                        showToast(getText("toast_achievement_unlocked_title"), getText("toast_achievement_unlocked_body", ach.name), 'success');
                        playSound('A5', '1n', 'achievement');
                        ach.notificationShown = true;
                    }
                }
            });
            if (newAchievementUnlockedThisCheck) {
                renderAchievements();
                updateAchievementTabNotificationBadge();
                saveData();
            }
        }

        startPauseButton.addEventListener('click', () => { isRunning ? pauseTimer() : startTimer(); });
        resetButton.addEventListener('click', resetCurrentTimer);
       
        addRewardButton.addEventListener('click', () => {
            const name = rewardNameInput.value.trim();
            const type = rewardTypeSelect.value;
            const threshold = parseFloat(rewardThresholdInput.value);
            if (!name || isNaN(threshold) || threshold < 0) {
                showToast(getText("toast_error_title"), getText("toast_rewards_error"), "error");
                return;
            }
            appData.rewards.push({ id: generateUUID(), name, type, threshold, earnedToday: false, notificationShown: false, seen: false });
            rewardNameInput.value = '';
            rewardThresholdInput.value = '';
            saveData();
            renderRewards();
        });

        resetCycleCountButtonEl.addEventListener('click', () => {
            showCustomAlert(
                getText("alert_reset_cycle_title"), 
                getText("alert_reset_cycle_body"), 
                "fas fa-exclamation-triangle text-yellow-400", 
                getText("confirm_button"), 
                getText("cancel_button"), 
                () => {
                    if (isRunning) pauseTimer();
                    pomodorosInCycle = 0;
                    appData.timerState.forcedBreakContextSession = null;
                    setTimer('study');
                    saveData();
                    console.log("Focus cycle count reset to 1/4 and timer set to Focus mode (paused).");
                }, 
                () => { console.log("Focus cycle reset cancelled."); }
            );
        });
       
        helpButton.addEventListener('click', () => {
            showCustomAlert(
                getText("alert_help_title"), 
                getText("alert_help_body"), 
                "fas fa-question-circle text-sky-400", 
                getText("got_it_button")
            );
        });

        skipBreakButton.addEventListener('click', () => {
            if (currentMode === 'shortBreak' || currentMode === 'longBreak') {
                const skippedMode = currentMode;
                let skippedTime = 0;
               
                if (skippedMode === 'shortBreak') {
                    skippedTime = appData.settings.shortBreakTime * 60;
                    appData.stats.general.totalShortBreakSeconds += skippedTime;
                } else if (skippedMode === 'longBreak') {
                    skippedTime = appData.settings.longBreakTime * 60;
                    appData.stats.general.totalLongBreakSeconds += skippedTime;
                    pomodorosInCycle = 0;
                }

                if (skippedTime > 0) {
                    appData.stats.daily.totalTimeTodaySeconds += skippedTime;
                    updateStatsDisplay();
                    checkAchievements();
                }

                if (timerWorker) timerWorker.postMessage({ command: 'pause' });
                isRunning = false;
               
                appData.timerState.forcedBreakContextSession = null;
                appData.timerState.persistedPreviousPomodorosInCycle = null;
                appData.timerState.lastTimerUsed = skippedMode;
                setTimer('study');
            }
        });

        settingsButton.addEventListener('click', () => settingsModal.classList.add('show'));
       
        cancelSettingsButton.addEventListener('click', () => {
            studyTimeInput.value = appData.settings.studyTime;
            shortBreakTimeInput.value = appData.settings.shortBreakTime;
            longBreakTimeInput.value = appData.settings.longBreakTime;
            soundToggle.checked = appData.settings.soundEnabled;
            languageSelect.value = appData.settings.language;
            settingsModal.classList.remove('show');
        });

        saveSettingsButton.addEventListener('click', () => {
            settingsModal.classList.remove('show');
            const newStudyTime = parseInt(studyTimeInput.value), newShortBreakTime = parseInt(shortBreakTimeInput.value), newLongBreakTime = parseInt(longBreakTimeInput.value);
            const newLanguage = languageSelect.value;
            const oldStudyTime = appData.settings.studyTime, oldShortBreakTime = appData.settings.shortBreakTime, oldLongBreakTime = appData.settings.longBreakTime;
           
            let settingsChanged = false;
            if (!isNaN(newStudyTime) && newStudyTime >= 1 && appData.settings.studyTime !== newStudyTime) { appData.settings.studyTime = newStudyTime; settingsChanged = true; }
            if (!isNaN(newShortBreakTime) && newShortBreakTime >= 1 && appData.settings.shortBreakTime !== newShortBreakTime) { appData.settings.shortBreakTime = newShortBreakTime; settingsChanged = true; }
            if (!isNaN(newLongBreakTime) && newLongBreakTime >= 1 && appData.settings.longBreakTime !== newLongBreakTime) { appData.settings.longBreakTime = newLongBreakTime; settingsChanged = true; }
            if (appData.settings.soundEnabled !== soundToggle.checked) { appData.settings.soundEnabled = soundToggle.checked; settingsChanged = true; }
           
            if (appData.settings.language !== newLanguage) {
                appData.settings.language = newLanguage;
                appData.achievements = buildAchievements(newLanguage, appData.achievements);
                settingsChanged = true; 
            }
           
            if (settingsChanged) {
                applyTranslations();
                renderAllDynamicContent();
                saveData();

                if (timerWorker) timerWorker.postMessage({ command: 'updateSettings', settings: appData.settings });
                if (!isRunning) {
                    let durationChangedForCurrentMode = false;
                    if (currentMode === 'study' && oldStudyTime !== appData.settings.studyTime) durationChangedForCurrentMode = true;
                    if (currentMode === 'shortBreak' && oldShortBreakTime !== appData.settings.shortBreakTime) durationChangedForCurrentMode = true;
                    if (currentMode === 'longBreak' && oldLongBreakTime !== appData.settings.longBreakTime) durationChangedForCurrentMode = true;
                   
                    let fullDurationForCurrentModeBeforeChange;
                    switch(currentMode) {
                        case 'study': fullDurationForCurrentModeBeforeChange = oldStudyTime * 60; break;
                        case 'shortBreak': fullDurationForCurrentModeBeforeChange = oldShortBreakTime * 60; break;
                        case 'longBreak': fullDurationForCurrentModeBeforeChange = oldLongBreakTime * 60; break;
                        default: fullDurationForCurrentModeBeforeChange = oldStudyTime * 60;
                    }
                    if (durationChangedForCurrentMode || timeLeft === 0 || timeLeft === fullDurationForCurrentModeBeforeChange) {
                        setTimer(currentMode);
                    } else {
                        saveTimerState();
                    }
                } else {
                    saveTimerState();
                }
                showToast(getText("toast_settings_saved_title"), getText("toast_settings_saved_body"), "success");
            }
        });

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                justSeenRewardIds = []; justSeenAchievementIds = [];
                const targetTab = button.dataset.tab;
                tabButtons.forEach(btn => {
                    btn.classList.remove('active', 'text-sky-400', 'border-sky-400');
                    btn.classList.add('text-slate-400', 'border-transparent');
                });
                button.classList.add('active', 'text-sky-400', 'border-sky-400');
                button.classList.remove('text-slate-400', 'border-transparent');
                tabPanes.forEach(pane => {
                    pane.style.display = 'none';
                });
                const targetPane = document.getElementById(`${targetTab}Content`);
                if(targetPane) targetPane.style.display = 'block';

                if (targetTab === 'rewards') {
                    appData.rewards.forEach(r => { if (r.earnedToday && !r.seen) justSeenRewardIds.push(r.id); if (r.earnedToday) r.seen = true; });
                    appData.uiState.newRewardsCount = 0;
                    updateRewardTabNotificationBadge();
                } else if (targetTab === 'achievements') {
                    appData.achievements.forEach(ach => { if (ach.unlocked && !ach.seen) justSeenAchievementIds.push(ach.id); if (ach.unlocked) ach.seen = true; });
                    appData.uiState.newAchievementsCount = 0;
                    updateAchievementTabNotificationBadge();
                }
                saveData();
                renderAllDynamicContent();
            });
        });

        // Data Management Logic
        exportDataButton.addEventListener('click', () => {
            try {
                const dataStr = JSON.stringify(appData, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `PomodoroCycle_Backup_${getTodayDateString()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (e) {
                console.error("Error exporting data:", e);
                showToast(getText('toast_error_title'), 'Could not export data.', 'error');
            }
        });

        importDataButton.addEventListener('click', () => {
            importFileInput.click();
        });

        importFileInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedData = JSON.parse(e.target.result);
                    // Basic validation
                    if (!importedData.settings || !importedData.stats || !importedData.achievements) {
                         throw new Error("Invalid backup file structure.");
                    }
                    
                    showCustomAlert(
                        getText("alert_import_title"),
                        getText("alert_import_body"),
                        "fas fa-exclamation-triangle text-yellow-400",
                        getText("confirm_button"),
                        getText("cancel_button"),
                        () => { // on Confirm
                            const freshDefaultData = JSON.parse(JSON.stringify(appData));
                            const mergedData = mergeDeep(freshDefaultData, importedData);
                            localStorage.setItem(STORAGE_KEY, JSON.stringify(mergedData));
                            showToast(getText("toast_import_success_title"), getText("toast_import_success_body"), "success", 3000);
                            setTimeout(() => {
                                location.reload();
                            }, 1000);
                        },
                        () => { // on Cancel
                            importFileInput.value = ''; // Reset file input
                        }
                    );

                } catch (error) {
                    console.error("Error importing data:", error);
                    showToast(getText('toast_import_error_title'), getText('toast_import_error_body'), 'error');
                    importFileInput.value = ''; // Reset file input
                }
            };
            reader.readAsText(file);
        });

        let timerWorker;
        if (window.Worker) {
            try {
                const workerScript = document.getElementById('timerWorkerScript').textContent;
                const blob = new Blob([workerScript], { type: 'application/javascript' });
                timerWorker = new Worker(URL.createObjectURL(blob));
                timerWorker.onmessage = function(e) {
                    const { type, timeLeft: workerTimeLeftUpdate, mode: workerMode } = e.data;
                    if (type === 'tick') {
                        timeLeft = workerTimeLeftUpdate;
                        if (currentMode === workerMode) updateTimerDisplay();
                    } else if (type === 'end') {
                        if (currentMode === workerMode) handleTimerEnd();
                    } else if (type === 'modeSet') {
                        timeLeft = workerTimeLeftUpdate;
                        updateTimerDisplay();
                    }
                };
                timerWorker.onerror = function(error) { console.error('Worker Error:', error); timerWorker = null; };
            } catch (e) {
                console.error('Error creating worker:', e);
                timerWorker = null;
            }
        } else {
            console.warn('Web Workers not supported. Timer will run on main thread.');
        }
       
        function startMidnightChecker() {
            setInterval(() => {
                const todayString = getTodayDateString();
                if (appData.stats.daily.date !== todayString) {
                    console.log('Midnight detected! Resetting daily stats automatically.');
                    showToast(getText("toast_new_day_title"), getText("toast_new_day_body"), "info");
                   
                    resetDailyStats();
                    saveData();
                   
                    updateStatsDisplay();
                    renderRewards();
                    renderAchievements();
                }
            }, 60000);
        }
       
        function renderAllDynamicContent() {
             updateTimerDisplay();
             updateStatsDisplay();
             renderRewards();
             renderAchievements();
        }

        function initializeApp() {
            appContainer.style.display = 'block';
            loadData();
           
            const todayStrInitialize = getTodayDateString();
            if (appData.stats.general.lastStudyDate && appData.stats.general.lastStudyDate !== todayStrInitialize) {
                const lastStudy = new Date(appData.stats.general.lastStudyDate), today = new Date(todayStrInitialize), yesterday = new Date(today);
                yesterday.setDate(today.getDate() - 1);
                lastStudy.setHours(0, 0, 0, 0);
                yesterday.setHours(0, 0, 0, 0);
                if (lastStudy.getTime() < yesterday.getTime()) {
                    appData.stats.general.streak = 0;
                    console.log("Streak reset to 0 due to inactivity upon app load.");
                }
            }
            if (appData.stats.daily.date !== getTodayDateString()) {
                resetDailyStats();
                if (appData.timerState) {
                    appData.timerState.persistedCurrentMode = 'study';
                    appData.timerState.persistedTimeLeft = appData.settings.studyTime * 60;
                    appData.timerState.persistedIsRunning = false;
                    appData.timerState.persistedPomodorosInCycle = 0;
                    appData.timerState.forcedBreakContextSession = null;
                }
                saveData();
            }
            let initialMode = 'study', initialTimeLeft = appData.settings.studyTime * 60, initialPomodorosInCycle = 0;
            if (appData.timerState && typeof appData.timerState.persistedTimeLeft === 'number' && !isNaN(appData.timerState.persistedTimeLeft) && appData.timerState.persistedCurrentMode && ['study', 'shortBreak', 'longBreak'].includes(appData.timerState.persistedCurrentMode)) {
                initialMode = appData.timerState.persistedCurrentMode;
                initialTimeLeft = appData.timerState.persistedTimeLeft;
                initialPomodorosInCycle = typeof appData.timerState.persistedPomodorosInCycle === 'number' ? appData.timerState.persistedPomodorosInCycle : 0;
            }
            currentMode = initialMode;
            timeLeft = initialTimeLeft;
            isRunning = false;
            pomodorosInCycle = initialPomodorosInCycle;
           
            if (timerWorker) {
                timerWorker.postMessage({ command: 'updateSettings', settings: appData.settings });
                timerWorker.postMessage({ command: 'setMode', mode: currentMode, duration: timeLeft });
            }

            applyTranslations(); 
           
            let fullDurationForMode;
            switch(currentMode) {
                case 'study': fullDurationForMode = appData.settings.studyTime * 60; break;
                case 'shortBreak': fullDurationForMode = appData.settings.shortBreakTime * 60; break;
                case 'longBreak': fullDurationForMode = appData.settings.longBreakTime * 60; break;
                default: fullDurationForMode = appData.settings.studyTime * 60;
            }
            if (appData.timerState.persistedIsRunning && timeLeft > 0) {
                isRunning = true;
                startPauseButton.querySelector('span').textContent = getText('pause_button');
                startPauseButton.querySelector('i').className = 'fas fa-pause mr-2';
                if (timerWorker) timerWorker.postMessage({ command: 'start' });
            } else if (timeLeft < fullDurationForMode && timeLeft > 0) {
                startPauseButton.querySelector('span').textContent = getText('resume_button');
                startPauseButton.querySelector('i').className = 'fas fa-play mr-2';
            } else {
                startPauseButton.querySelector('span').textContent = getText('start_button');
                startPauseButton.querySelector('i').className = 'fas fa-play mr-2';
            }
           
            renderAllDynamicContent();
            updateRewardTabNotificationBadge();
            updateAchievementTabNotificationBadge();

            startMidnightChecker();
        }

        function handleFirstVisit() {
            const languageDisplayNames = {
                'en': 'English',
                'pt-BR': 'Portugu√™s (Brasil)',
                'es': 'Espa√±ol',
                'zh-CN': '‰∏≠Êñá (ÁÆÄ‰Ωì)',
                'hi-IN': '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä'
            };

            Object.entries(languageDisplayNames).forEach(([code, name]) => {
                const button = document.createElement('button');
                button.textContent = name;
                button.dataset.lang = code;
                button.className = "w-full px-6 py-3 bg-slate-700 hover:bg-sky-500 rounded-lg transition-colors font-semibold";
                languageButtonsContainer.appendChild(button);
            });
           
            languageButtonsContainer.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON' && e.target.dataset.lang) {
                    const selectedLang = e.target.dataset.lang;
                    appData.settings.language = selectedLang;
                    saveData();
                    languageModal.classList.remove('show');
                    initializeApp();
                }
            });

            languageModal.classList.add('show');
        }

        window.addEventListener('beforeunload', saveTimerState);
        document.addEventListener('DOMContentLoaded', () => {
            if (!localStorage.getItem(STORAGE_KEY)) {
                handleFirstVisit();
            } else {
                initializeApp();
            }
        });
    </script>
</body>
</html>
